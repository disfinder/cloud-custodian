

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>aws.ec2 resources &mdash; Cloud Custodian  documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/icon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script type="text/javascript" src="../../_static/js/expand.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/expand.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="aws.ecr resources" href="ecr.html" />
    <link rel="prev" title="aws.dynamodbstreams resources" href="dynamodbstreams.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Cloud Custodian
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../filters.html">Generic Filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../actions.html">Generic Actions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart/advanced.html">Advanced Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart/policyStructure.html">Example tag compliance policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../deployment.html">Deployment</a></li>
</ul>
<p class="caption"><span class="caption-text">AWS</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../gettingstarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Example Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aws-modes.html">AWS Modes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Monitoring your environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lambda.html">Lambda Support</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">AWS Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="aws-common-actions.html">AWS Common Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="aws-common-filters.html">AWS Common Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="account.html">aws.account resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="acm.html">aws.acm resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="apigateway.html">aws.apigateway resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="autoscaling.html">aws.autoscaling resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="backup.html">aws.backup resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="batch.html">aws.batch resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="clouddirectory.html">aws.clouddirectory resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="cloudformation.html">aws.cloudformation resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="cloudfront.html">aws.cloudfront resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="cloudhsm.html">aws.cloudhsm resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="cloudhsmv2.html">aws.cloudhsmv2 resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="cloudsearch.html">aws.cloudsearch resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="cloudtrail.html">aws.cloudtrail resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="cloudwatch.html">aws.cloudwatch resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="codebuild.html">aws.codebuild resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="codecommit.html">aws.codecommit resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="codepipeline.html">aws.codepipeline resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="cognito-identity.html">aws.cognito-identity resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="cognito-idp.html">aws.cognito-idp resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html">aws.config resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="datapipeline.html">aws.datapipeline resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="dax.html">aws.dax resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="directconnect.html">aws.directconnect resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="dlm.html">aws.dlm resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="dms.html">aws.dms resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="ds.html">aws.ds resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="dynamodb.html">aws.dynamodb resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="dynamodbstreams.html">aws.dynamodbstreams resources</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">aws.ec2 resources</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#aws-ami">aws.ami</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#filters">Filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#actions">Actions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#aws-customer-gateway">aws.customer-gateway</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id3">Filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4">Actions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#aws-ebs">aws.ebs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id6">Filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id7">Actions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#aws-ebs-snapshot">aws.ebs-snapshot</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id9">Filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id12">Actions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#aws-ec2">aws.ec2</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id16">Filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id18">Actions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#aws-ec2-reserved">aws.ec2-reserved</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id21">Filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id22">Actions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#aws-eni">aws.eni</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id24">Filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id25">Actions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#aws-internet-gateway">aws.internet-gateway</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id28">Filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id30">Actions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#aws-key-pair">aws.key-pair</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id32">Filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id33">Actions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#aws-launch-template-version">aws.launch-template-version</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id35">Filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id36">Actions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#aws-nat-gateway">aws.nat-gateway</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id38">Filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id39">Actions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#aws-network-acl">aws.network-acl</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id42">Filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id44">Actions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#aws-network-addr">aws.network-addr</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id46">Filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id48">Actions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#aws-peering-connection">aws.peering-connection</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id50">Filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id52">Actions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#aws-route-table">aws.route-table</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id54">Filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id55">Actions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#aws-security-group">aws.security-group</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id57">Filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id61">Actions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#aws-subnet">aws.subnet</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id64">Filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id67">Actions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#aws-transit-attachment">aws.transit-attachment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id70">Filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id71">Actions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#aws-transit-gateway">aws.transit-gateway</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id73">Filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id74">Actions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#aws-vpc">aws.vpc</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id76">Filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id79">Actions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#aws-vpc-endpoint">aws.vpc-endpoint</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id82">Filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id84">Actions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#aws-vpn-connection">aws.vpn-connection</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id86">Filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id88">Actions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#aws-vpn-gateway">aws.vpn-gateway</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id90">Filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id92">Actions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ecr.html">aws.ecr resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="ecs.html">aws.ecs resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="efs.html">aws.efs resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="eks.html">aws.eks resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="elasticache.html">aws.elasticache resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="elasticbeanstalk.html">aws.elasticbeanstalk resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="elb.html">aws.elb resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="elbv2.html">aws.elbv2 resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="emr.html">aws.emr resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="es.html">aws.es resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="events.html">aws.events resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="firehose.html">aws.firehose resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="fsx.html">aws.fsx resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="gamelift.html">aws.gamelift resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="glacier.html">aws.glacier resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="glue.html">aws.glue resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="health.html">aws.health resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="iam.html">aws.iam resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="iot.html">aws.iot resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="kafka.html">aws.kafka resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="kinesis.html">aws.kinesis resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="kinesisanalytics.html">aws.kinesisanalytics resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="kms.html">aws.kms resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="lambda.html">aws.lambda resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="lightsail.html">aws.lightsail resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="logs.html">aws.logs resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="machinelearning.html">aws.machinelearning resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="mq.html">aws.mq resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="opsworks.html">aws.opsworks resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="opsworkscm.html">aws.opsworkscm resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="rds.html">aws.rds resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="redshift.html">aws.redshift resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="route53.html">aws.route53 resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="route53domains.html">aws.route53domains resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="s3.html">aws.s3 resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="sagemaker.html">aws.sagemaker resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="sdb.html">aws.sdb resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="secretsmanager.html">aws.secretsmanager resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="shield.html">aws.shield resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="snowball.html">aws.snowball resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="sns.html">aws.sns resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="sqs.html">aws.sqs resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="ssm.html">aws.ssm resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="stepfunctions.html">aws.stepfunctions resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="storagegateway.html">aws.storagegateway resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="support.html">aws.support resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="waf.html">aws.waf resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="waf-regional.html">aws.waf-regional resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="workspaces.html">aws.workspaces resources</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Azure</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../azure/gettingstarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../azure/authentication.html">Authentication &amp; Access</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../azure/examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../azure/policy/index.html">Supported Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../azure/azure-modes.html">Azure Modes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../azure/advanced/index.html">Advanced Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../azure/contribute.html">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../azure/resources/index.html">Azure Reference</a></li>
</ul>
<p class="caption"><span class="caption-text">GCP</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../gcp/gettingstarted.html">Getting Started (Beta)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gcp/gcp-modes.html">GCP Modes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gcp/examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gcp/policy/index.html">Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gcp/contribute.html">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gcp/contribute.html#adding-new-gcp-resources">Adding New GCP Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gcp/contribute.html#testing">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gcp/resources/index.html">GCP Reference</a></li>
</ul>
<p class="caption"><span class="caption-text">Tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tools/c7n-org.html">c7n-org: Multi Account Custodian Execution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/c7n-policystream.html">c7n-policystream: Policy Changes from Git</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/c7n-mailer.html">c7n-mailer: Custodian Mailer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/c7n-trailcreator.html">AWS Retroactive Tagging Resource Creators</a></li>
</ul>
<p class="caption"><span class="caption-text">Contributing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contribute.html">Contributing to Cloud Custodian</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developer/index.html">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developer/installing.html">Installing for Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developer/tests.html">Testing for Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developer/documentation.html">Documentation For Developers</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Cloud Custodian</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">AWS Reference</a> &raquo;</li>
        
      <li>aws.ec2 resources</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="aws-ec2-resources">
<h1>aws.ec2 resources<a class="headerlink" href="#aws-ec2-resources" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="#aws-ami"><span class="std std-ref">aws.ami</span></a></p></li>
<li><p><a class="reference internal" href="#aws-customer-gateway"><span class="std std-ref">aws.customer-gateway</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ebs"><span class="std std-ref">aws.ebs</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ebs-snapshot"><span class="std std-ref">aws.ebs-snapshot</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ec2"><span class="std std-ref">aws.ec2</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ec2-reserved"><span class="std std-ref">aws.ec2-reserved</span></a></p></li>
<li><p><a class="reference internal" href="#aws-eni"><span class="std std-ref">aws.eni</span></a></p></li>
<li><p><a class="reference internal" href="#aws-internet-gateway"><span class="std std-ref">aws.internet-gateway</span></a></p></li>
<li><p><a class="reference internal" href="#aws-key-pair"><span class="std std-ref">aws.key-pair</span></a></p></li>
<li><p><a class="reference internal" href="#aws-launch-template-version"><span class="std std-ref">aws.launch-template-version</span></a></p></li>
<li><p><a class="reference internal" href="#aws-nat-gateway"><span class="std std-ref">aws.nat-gateway</span></a></p></li>
<li><p><a class="reference internal" href="#aws-network-acl"><span class="std std-ref">aws.network-acl</span></a></p></li>
<li><p><a class="reference internal" href="#aws-network-addr"><span class="std std-ref">aws.network-addr</span></a></p></li>
<li><p><a class="reference internal" href="#aws-peering-connection"><span class="std std-ref">aws.peering-connection</span></a></p></li>
<li><p><a class="reference internal" href="#aws-route-table"><span class="std std-ref">aws.route-table</span></a></p></li>
<li><p><a class="reference internal" href="#aws-security-group"><span class="std std-ref">aws.security-group</span></a></p></li>
<li><p><a class="reference internal" href="#aws-subnet"><span class="std std-ref">aws.subnet</span></a></p></li>
<li><p><a class="reference internal" href="#aws-transit-attachment"><span class="std std-ref">aws.transit-attachment</span></a></p></li>
<li><p><a class="reference internal" href="#aws-transit-gateway"><span class="std std-ref">aws.transit-gateway</span></a></p></li>
<li><p><a class="reference internal" href="#aws-vpc"><span class="std std-ref">aws.vpc</span></a></p></li>
<li><p><a class="reference internal" href="#aws-vpc-endpoint"><span class="std std-ref">aws.vpc-endpoint</span></a></p></li>
<li><p><a class="reference internal" href="#aws-vpn-connection"><span class="std std-ref">aws.vpn-connection</span></a></p></li>
<li><p><a class="reference internal" href="#aws-vpn-gateway"><span class="std std-ref">aws.vpn-gateway</span></a></p></li>
</ul>
</div></blockquote>
<div class="section" id="aws-ami">
<span id="id1"></span><h2>aws.ami<a class="headerlink" href="#aws-ami" title="Permalink to this headline">¶</a></h2>
<div class="section" id="filters">
<h3>Filters<a class="headerlink" href="#filters" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="#aws-ami-filters-cross-account"><span class="std std-ref">cross-account</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-event"><span class="std std-ref">event</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-finding"><span class="std std-ref">finding</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ami-filters-image-age"><span class="std std-ref">image-age</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-marked-for-op"><span class="std std-ref">marked-for-op</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-tag-count"><span class="std std-ref">tag-count</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ami-filters-unused"><span class="std std-ref">unused</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-value"><span class="std std-ref">value</span></a></p></li>
</ul>
</div></blockquote>
<div class="section" id="cross-account">
<span id="aws-ami-filters-cross-account"></span><h4>cross-account<a class="headerlink" href="#cross-account" title="Permalink to this headline">¶</a></h4>
<p>Check a resource’s embedded iam policy for cross account access.</p>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cross-account</span>
  <span class="nt">whitelist</span><span class="p">:</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
  <span class="nt">whitelist_from</span><span class="p">:</span>
    <span class="nt">additionalProperties</span><span class="p">:</span> <span class="s">&#39;False&#39;</span>
    <span class="nt">properties</span><span class="p">:</span>
      <span class="nt">expr</span><span class="p">:</span>
        <span class="nt">oneOf</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
        <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
      <span class="nt">format</span><span class="p">:</span>
        <span class="nt">enum</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">csv</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">json</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">txt</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">csv2dict</span>
      <span class="nt">url</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">required</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">url</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="image-age">
<span id="aws-ami-filters-image-age"></span><h4>image-age<a class="headerlink" href="#image-age" title="Permalink to this headline">¶</a></h4>
<p>Filters images based on the age (in days)</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ami-remove-launch-permissions</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ami</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">image-age</span>
        <span class="nt">days</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">30</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">days</span><span class="p">:</span>
    <span class="nt">minimum</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
  <span class="nt">op</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">eq</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">equal</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ne</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not-equal</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">gt</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">greater-than</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ge</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">gte</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">le</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lte</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lt</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">less-than</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">glob</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">regex</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">regex-case</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">in</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ni</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not-in</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">contains</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">difference</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">intersect</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">image-age</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="unused">
<span id="aws-ami-filters-unused"></span><h4>unused<a class="headerlink" href="#unused" title="Permalink to this headline">¶</a></h4>
<p>Filters images based on usage</p>
<p>true: image has no instances spawned from it
false: image has instances spawned from it</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ami-unused</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ami</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">unused</span>
        <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">unused</span>
  <span class="nt">value</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="actions">
<h3>Actions<a class="headerlink" href="#actions" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-auto-tag-user"><span class="std std-ref">auto-tag-user</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ami-actions-copy"><span class="std std-ref">copy</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-copy-related-tag"><span class="std std-ref">copy-related-tag</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ami-actions-deregister"><span class="std std-ref">deregister</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-lambda"><span class="std std-ref">invoke-lambda</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-sfn"><span class="std std-ref">invoke-sfn</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-mark-for-op"><span class="std std-ref">mark-for-op</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-normalize-tag"><span class="std std-ref">normalize-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-notify"><span class="std std-ref">notify</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-post-finding"><span class="std std-ref">post-finding</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-put-metric"><span class="std std-ref">put-metric</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ami-actions-remove-launch-permissions"><span class="std std-ref">remove-launch-permissions</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-remove-tag"><span class="std std-ref">remove-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-rename-tag"><span class="std std-ref">rename-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag"><span class="std std-ref">tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag-trim"><span class="std std-ref">tag-trim</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-webhook"><span class="std std-ref">webhook</span></a></p></li>
</ul>
</div></blockquote>
<div class="section" id="copy">
<span id="aws-ami-actions-copy"></span><h4>copy<a class="headerlink" href="#copy" title="Permalink to this headline">¶</a></h4>
<p>Action to copy AMIs with optional encryption</p>
<p>This action can copy AMIs while optionally encrypting or decrypting
the target AMI. It is advised to use in conjunction with a filter.</p>
<p>Note there is a max in flight of 5 per account/region.</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ami-ensure-encrypted</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ami</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">value</span>
        <span class="nt">key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">encrypted</span>
        <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class="nt">actions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">copy</span>
        <span class="nt">encrypt</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">key-id</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">00000000-0000-0000-0000-000000000000</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">description</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">encrypt</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">key-id</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">name</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">region</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">copy</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="deregister">
<span id="aws-ami-actions-deregister"></span><h4>deregister<a class="headerlink" href="#deregister" title="Permalink to this headline">¶</a></h4>
<p>Action to deregister AMI</p>
<p>To prevent deregistering all AMI, it is advised to use in conjunction with
a filter (such as image-age)</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ami-deregister-old</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ami</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">image-age</span>
        <span class="nt">days</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">90</span>
    <span class="nt">actions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">deregister</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">delete-snapshots</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">deregister</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="remove-launch-permissions">
<span id="aws-ami-actions-remove-launch-permissions"></span><h4>remove-launch-permissions<a class="headerlink" href="#remove-launch-permissions" title="Permalink to this headline">¶</a></h4>
<p>Action to remove the ability to launch an instance from an AMI</p>
<p>This action will remove any launch permissions granted to other
AWS accounts from the image, leaving only the owner capable of
launching it</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ami-stop-share-old</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ami</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">image-age</span>
        <span class="nt">days</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">60</span>
    <span class="nt">actions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">remove-launch-permissions</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">remove-launch-permissions</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="aws-customer-gateway">
<span id="id2"></span><h2>aws.customer-gateway<a class="headerlink" href="#aws-customer-gateway" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id3">
<h3>Filters<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-event"><span class="std std-ref">event</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-finding"><span class="std std-ref">finding</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-marked-for-op"><span class="std std-ref">marked-for-op</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-tag-count"><span class="std std-ref">tag-count</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-value"><span class="std std-ref">value</span></a></p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="id4">
<h3>Actions<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-auto-tag-user"><span class="std std-ref">auto-tag-user</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-copy-related-tag"><span class="std std-ref">copy-related-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-lambda"><span class="std std-ref">invoke-lambda</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-sfn"><span class="std std-ref">invoke-sfn</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-mark-for-op"><span class="std std-ref">mark-for-op</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-normalize-tag"><span class="std std-ref">normalize-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-notify"><span class="std std-ref">notify</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-post-finding"><span class="std std-ref">post-finding</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-put-metric"><span class="std std-ref">put-metric</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-remove-tag"><span class="std std-ref">remove-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-rename-tag"><span class="std std-ref">rename-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag"><span class="std std-ref">tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag-trim"><span class="std std-ref">tag-trim</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-webhook"><span class="std std-ref">webhook</span></a></p></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="aws-ebs">
<span id="id5"></span><h2>aws.ebs<a class="headerlink" href="#aws-ebs" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id6">
<h3>Filters<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-config-compliance"><span class="std std-ref">config-compliance</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-event"><span class="std std-ref">event</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ebs-filters-fault-tolerant"><span class="std std-ref">fault-tolerant</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-finding"><span class="std std-ref">finding</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ebs-filters-health-event"><span class="std std-ref">health-event</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ebs-filters-instance"><span class="std std-ref">instance</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ebs-filters-kms-alias"><span class="std std-ref">kms-alias</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-marked-for-op"><span class="std std-ref">marked-for-op</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-metrics"><span class="std std-ref">metrics</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ebs-filters-modifyable"><span class="std std-ref">modifyable</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-tag-count"><span class="std std-ref">tag-count</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-value"><span class="std std-ref">value</span></a></p></li>
</ul>
</div></blockquote>
<div class="section" id="fault-tolerant">
<span id="aws-ebs-filters-fault-tolerant"></span><h4>fault-tolerant<a class="headerlink" href="#fault-tolerant" title="Permalink to this headline">¶</a></h4>
<p>This filter will return any EBS volume that does/does not have a
snapshot within the last 7 days. ‘Fault-Tolerance’ in this instance
means that, in the event of a failure, the volume can be restored
from a snapshot with (reasonable) data loss</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
 <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ebs-volume-tolerance</span>
   <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ebs</span>
   <span class="nt">filters</span><span class="p">:</span>
     <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">fault-tolerant</span>
       <span class="nt">tolerant</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">tolerant</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">fault-tolerant</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="health-event">
<span id="aws-ebs-filters-health-event"></span><h4>health-event<a class="headerlink" href="#health-event" title="Permalink to this headline">¶</a></h4>
<p>Check if there are operations health events (phd) related to the resources</p>
<p><a class="reference external" href="https://aws.amazon.com/premiumsupport/technology/personal-health-dashboard/">https://aws.amazon.com/premiumsupport/technology/personal-health-dashboard/</a></p>
<p>Health events are stored as annotation on a resource.</p>
<p>Custodian also supports responding to phd events via a lambda execution mode.</p>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">statuses</span><span class="p">:</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">enum</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">open</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">upcoming</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">closed</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">health-event</span>
  <span class="nt">types</span><span class="p">:</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">enum</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">AWS_EBS_DEGRADED_EBS_VOLUME_PERFORMANCE</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">AWS_EBS_VOLUME_LOST</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="instance">
<span id="aws-ebs-filters-instance"></span><h4>instance<a class="headerlink" href="#instance" title="Permalink to this headline">¶</a></h4>
<p>Filter volumes based on filtering on their attached instance</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">instance-ebs-volumes</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ebs</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">instance</span>
        <span class="nt">key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">tag:Name</span>
        <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">OldManBySea</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">default</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
  <span class="nt">key</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">op</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">eq</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">equal</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ne</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not-equal</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">gt</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">greater-than</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ge</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">gte</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">le</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lte</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lt</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">less-than</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">glob</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">regex</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">regex-case</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">in</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ni</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not-in</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">contains</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">difference</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">intersect</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">instance</span>
  <span class="nt">value</span><span class="p">:</span>
    <span class="nt">oneOf</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="s">&#39;null&#39;</span>
  <span class="nt">value_from</span><span class="p">:</span>
    <span class="nt">additionalProperties</span><span class="p">:</span> <span class="s">&#39;False&#39;</span>
    <span class="nt">properties</span><span class="p">:</span>
      <span class="nt">expr</span><span class="p">:</span>
        <span class="nt">oneOf</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
        <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
      <span class="nt">format</span><span class="p">:</span>
        <span class="nt">enum</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">csv</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">json</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">txt</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">csv2dict</span>
      <span class="nt">url</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">required</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">url</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
  <span class="nt">value_regex</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">value_type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">age</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">expiration</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">normalize</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">size</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cidr</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cidr_size</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">swap</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">resource_count</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">expr</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">unique_size</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">date</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="kms-alias">
<span id="aws-ebs-filters-kms-alias"></span><h4>kms-alias<a class="headerlink" href="#kms-alias" title="Permalink to this headline">¶</a></h4>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">default</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
  <span class="nt">key</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">op</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">eq</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">equal</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ne</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not-equal</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">gt</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">greater-than</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ge</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">gte</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">le</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lte</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lt</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">less-than</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">glob</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">regex</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">regex-case</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">in</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ni</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not-in</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">contains</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">difference</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">intersect</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">kms-alias</span>
  <span class="nt">value</span><span class="p">:</span>
    <span class="nt">oneOf</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="s">&#39;null&#39;</span>
  <span class="nt">value_from</span><span class="p">:</span>
    <span class="nt">additionalProperties</span><span class="p">:</span> <span class="s">&#39;False&#39;</span>
    <span class="nt">properties</span><span class="p">:</span>
      <span class="nt">expr</span><span class="p">:</span>
        <span class="nt">oneOf</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
        <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
      <span class="nt">format</span><span class="p">:</span>
        <span class="nt">enum</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">csv</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">json</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">txt</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">csv2dict</span>
      <span class="nt">url</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">required</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">url</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
  <span class="nt">value_regex</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">value_type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">age</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">expiration</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">normalize</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">size</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cidr</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cidr_size</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">swap</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">resource_count</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">expr</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">unique_size</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">date</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="modifyable">
<span id="aws-ebs-filters-modifyable"></span><h4>modifyable<a class="headerlink" href="#modifyable" title="Permalink to this headline">¶</a></h4>
<p>Check if an ebs volume is modifyable online.</p>
<dl class="simple">
<dt>Considerations:</dt><dd><p><a class="reference external" href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/limitations.html">https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/limitations.html</a></p>
</dd>
<dt>Consideration Summary</dt><dd><ul class="simple">
<li><p>only current instance types are supported (one exception m3.medium)
Current Generation Instances (2017-2)
<a class="reference external" href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instance-types.html#current-gen-instances">https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instance-types.html#current-gen-instances</a></p></li>
<li><p>older magnetic volume types are not supported</p></li>
<li><p>shrinking volumes is not supported</p></li>
<li><p>must wait at least 6hrs between modifications to the same volume.</p></li>
<li><p>volumes must have been attached after nov 1st, 2016.</p></li>
</ul>
</dd>
</dl>
<p>See <a class="reference internal" href="#aws-ebs-actions-modify"><span class="std std-ref">modify action</span></a> for examples.</p>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">modifyable</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id7">
<h3>Actions<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-auto-tag-user"><span class="std std-ref">auto-tag-user</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ebs-actions-copy-instance-tags"><span class="std std-ref">copy-instance-tags</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-copy-related-tag"><span class="std std-ref">copy-related-tag</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ebs-actions-delete"><span class="std std-ref">delete</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ebs-actions-detach"><span class="std std-ref">detach</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ebs-actions-encrypt-instance-volumes"><span class="std std-ref">encrypt-instance-volumes</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-lambda"><span class="std std-ref">invoke-lambda</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-sfn"><span class="std std-ref">invoke-sfn</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-mark-for-op"><span class="std std-ref">mark-for-op</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ebs-actions-modify"><span class="std std-ref">modify</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-normalize-tag"><span class="std std-ref">normalize-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-notify"><span class="std std-ref">notify</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-post-finding"><span class="std std-ref">post-finding</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-put-metric"><span class="std std-ref">put-metric</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-remove-tag"><span class="std std-ref">remove-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-rename-tag"><span class="std std-ref">rename-tag</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ebs-actions-snapshot"><span class="std std-ref">snapshot</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag"><span class="std std-ref">tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag-trim"><span class="std std-ref">tag-trim</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-webhook"><span class="std std-ref">webhook</span></a></p></li>
</ul>
</div></blockquote>
<div class="section" id="copy-instance-tags">
<span id="aws-ebs-actions-copy-instance-tags"></span><h4>copy-instance-tags<a class="headerlink" href="#copy-instance-tags" title="Permalink to this headline">¶</a></h4>
<p>Copy instance tags to its attached volume.</p>
<p>Useful for cost allocation to ebs volumes and tracking usage
info for volumes.</p>
<p>Mostly useful for volumes not set to delete on termination, which
are otherwise candidates for garbage collection, copying the
instance tags gives us more semantic information to determine if
their useful, as well letting us know the last time the volume
was actually used.</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ebs-copy-instance-tags</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ebs</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">value</span>
        <span class="nt">key</span><span class="p">:</span> <span class="s">&quot;Attachments[0].Device&quot;</span>
        <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">not-null</span>
    <span class="nt">actions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">copy-instance-tags</span>
        <span class="nt">tags</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Name</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">tags</span><span class="p">:</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">copy-instance-tags</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="delete">
<span id="aws-ebs-actions-delete"></span><h4>delete<a class="headerlink" href="#delete" title="Permalink to this headline">¶</a></h4>
<p>Delete an ebs volume.</p>
<p>If the force boolean is true, we will detach an attached volume
from an instance. Note this cannot be done for running instance
root volumes.</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">delete-unattached-volumes</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ebs</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">Attachments</span><span class="p">:</span> <span class="p p-Indicator">[]</span>
      <span class="p p-Indicator">-</span> <span class="nt">State</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">available</span>
    <span class="nt">actions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">delete</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">force</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">delete</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="detach">
<span id="aws-ebs-actions-detach"></span><h4>detach<a class="headerlink" href="#detach" title="Permalink to this headline">¶</a></h4>
<p>Detach an EBS volume from an Instance.</p>
<p>If ‘Force’ Param is True, then we’ll do a forceful detach
of the Volume. The default value for ‘Force’ is False.</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">detach-ebs-volumes</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ebs</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">VolumeId </span><span class="p">:</span>  <span class="l l-Scalar l-Scalar-Plain">volumeid</span>
    <span class="nt">actions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">detach</span>
</pre></div>
</div>
</div></blockquote>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">force</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">detach</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="encrypt-instance-volumes">
<span id="aws-ebs-actions-encrypt-instance-volumes"></span><h4>encrypt-instance-volumes<a class="headerlink" href="#encrypt-instance-volumes" title="Permalink to this headline">¶</a></h4>
<p>Encrypt extant volumes attached to an instance</p>
<ul class="simple">
<li><p>Requires instance restart</p></li>
<li><p>Not suitable for autoscale groups.</p></li>
</ul>
<p>Multistep process:</p>
<ul class="simple">
<li><p>Stop instance (if running)</p></li>
<li><dl class="simple">
<dt>For each volume</dt><dd><ul>
<li><p>Create snapshot</p></li>
<li><p>Wait on snapshot creation</p></li>
<li><p>Copy Snapshot to create encrypted snapshot</p></li>
<li><p>Wait on snapshot creation</p></li>
<li><p>Create encrypted volume from snapshot</p></li>
<li><p>Wait on volume creation</p></li>
<li><p>Delete transient snapshots</p></li>
<li><p>Detach Unencrypted Volume</p></li>
<li><p>Attach Encrypted Volume</p></li>
<li><p>Set DeleteOnTermination instance attribute equal to source volume</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>For each volume</dt><dd><ul>
<li><p>Delete unencrypted volume</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Start Instance (if originally running)</p></li>
<li><dl class="simple">
<dt>For each newly encrypted volume</dt><dd><ul>
<li><p>Delete transient tags</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">encrypt-unencrypted-ebs</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ebs</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">Encrypted</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="nt">actions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">encrypt-instance-volumes</span>
        <span class="nt">key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">alias/encrypted</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">delay</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
  <span class="nt">key</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">encrypt-instance-volumes</span>
  <span class="nt">verbose</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">key</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="modify">
<span id="aws-ebs-actions-modify"></span><h4>modify<a class="headerlink" href="#modify" title="Permalink to this headline">¶</a></h4>
<p>Modify an ebs volume online.</p>
<p><strong>Note this action requires use of modifyable filter</strong></p>
<dl class="simple">
<dt>Intro Blog &amp; Use Cases:</dt><dd><p><a class="reference external" href="https://aws.amazon.com/blogs/aws/amazon-ebs-update-new-elastic-volumes-change-everything/">https://aws.amazon.com/blogs/aws/amazon-ebs-update-new-elastic-volumes-change-everything/</a></p>
</dd>
<dt>Docs:</dt><dd><p><a class="reference external" href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ebs-modify-volume.html">https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ebs-modify-volume.html</a></p>
</dd>
<dt>Considerations:</dt><dd><p><a class="reference external" href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/limitations.html">https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/limitations.html</a></p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p>Find under utilized provisioned iops volumes older than a week
and change their type.</p>
</dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
 <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ebs-remove-piops</span>
   <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ebs</span>
   <span class="nt">filters</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">value</span>
      <span class="nt">key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">CreateDate</span>
      <span class="nt">value_type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">age</span>
      <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">7</span>
      <span class="nt">op</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">greater-than</span>
    <span class="p p-Indicator">-</span> <span class="nt">VolumeType</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">io1</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">metrics</span>
      <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">VolumeConsumedReadWriteOps</span>
      <span class="nt">statistics</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Maximum</span>
      <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">100</span>
      <span class="nt">op</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">less-than</span>
      <span class="nt">days</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">7</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">modifyable</span>
   <span class="nt">actions</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">modify</span>
      <span class="nt">volume-type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">gp2</span>
</pre></div>
</div>
<p><cite>iops-percent</cite> and <cite>size-percent</cite> can be used to modify
respectively iops on io1 volumes and volume size.</p>
<p>When converting to io1, <cite>iops-percent</cite> is used to set the iops
allocation for the new volume against the extant value for the old
volume.</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p>Double storage and quadruple iops for all io1 volumes.</p>
</dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
 <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ebs-upsize-piops</span>
   <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ebs</span>
   <span class="nt">filters</span><span class="p">:</span>
     <span class="p p-Indicator">-</span> <span class="nt">VolumeType</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">io1</span>
     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">modifyable</span>
   <span class="nt">actions</span><span class="p">:</span>
     <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">modify</span>
       <span class="nt">size-percent</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">200</span>
       <span class="nt">iops-percent</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">400</span>
</pre></div>
</div>
<p><strong>Note</strong> resizing down aka shrinking requires OS and FS support
and potentially additional preparation, else data-loss may occur.
To prevent accidents, shrinking must be explicitly enabled by also
setting <cite>shrink: true</cite> on the action.</p>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">iops-percent</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
  <span class="nt">shrink</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
  <span class="nt">size-percent</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">modify</span>
  <span class="nt">volume-type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">io1</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">gp2</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">st1</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">sc1</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="snapshot">
<span id="aws-ebs-actions-snapshot"></span><h4>snapshot<a class="headerlink" href="#snapshot" title="Permalink to this headline">¶</a></h4>
<p>Snapshot an EBS volume</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">snapshot-volumes</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ebs</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">Attachments</span><span class="p">:</span> <span class="p p-Indicator">[]</span>
      <span class="p p-Indicator">-</span> <span class="nt">State</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">available</span>
    <span class="nt">actions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">snapshot</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">snapshot</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="aws-ebs-snapshot">
<span id="id8"></span><h2>aws.ebs-snapshot<a class="headerlink" href="#aws-ebs-snapshot" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id9">
<h3>Filters<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="#aws-ebs-snapshot-filters-age"><span class="std std-ref">age</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ebs-snapshot-filters-cross-account"><span class="std std-ref">cross-account</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-event"><span class="std std-ref">event</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-finding"><span class="std std-ref">finding</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-marked-for-op"><span class="std std-ref">marked-for-op</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ebs-snapshot-filters-skip-ami-snapshots"><span class="std std-ref">skip-ami-snapshots</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-tag-count"><span class="std std-ref">tag-count</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ebs-snapshot-filters-unused"><span class="std std-ref">unused</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-value"><span class="std std-ref">value</span></a></p></li>
</ul>
</div></blockquote>
<div class="section" id="age">
<span id="aws-ebs-snapshot-filters-age"></span><h4>age<a class="headerlink" href="#age" title="Permalink to this headline">¶</a></h4>
<p>EBS Snapshot Age Filter</p>
<p>Filters an EBS snapshot based on the age of the snapshot (in days)</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ebs-snapshots-week-old</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ebs-snapshot</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">age</span>
        <span class="nt">days</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">7</span>
        <span class="nt">op</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ge</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">days</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
  <span class="nt">op</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">eq</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">equal</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ne</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not-equal</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">gt</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">greater-than</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ge</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">gte</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">le</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lte</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lt</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">less-than</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">glob</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">regex</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">regex-case</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">in</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ni</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not-in</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">contains</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">difference</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">intersect</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">age</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="aws-ebs-snapshot-filters-cross-account">
<span id="id10"></span><h4>cross-account<a class="headerlink" href="#aws-ebs-snapshot-filters-cross-account" title="Permalink to this headline">¶</a></h4>
<p>Check a resource’s embedded iam policy for cross account access.</p>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">actions</span><span class="p">:</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
  <span class="nt">everyone_only</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cross-account</span>
  <span class="nt">whitelist</span><span class="p">:</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
  <span class="nt">whitelist_conditions</span><span class="p">:</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
  <span class="nt">whitelist_from</span><span class="p">:</span> <span class="nl">&amp;id001</span>
    <span class="nt">additionalProperties</span><span class="p">:</span> <span class="s">&#39;False&#39;</span>
    <span class="nt">properties</span><span class="p">:</span>
      <span class="nt">expr</span><span class="p">:</span>
        <span class="nt">oneOf</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
        <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
      <span class="nt">format</span><span class="p">:</span>
        <span class="nt">enum</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">csv</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">json</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">txt</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">csv2dict</span>
      <span class="nt">url</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">required</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">url</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
  <span class="nt">whitelist_orgids</span><span class="p">:</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
  <span class="nt">whitelist_orgids_from</span><span class="p">:</span> <span class="nv">*id001</span>
  <span class="nt">whitelist_vpc</span><span class="p">:</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
  <span class="nt">whitelist_vpc_from</span><span class="p">:</span> <span class="nv">*id001</span>
  <span class="nt">whitelist_vpce</span><span class="p">:</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
  <span class="nt">whitelist_vpce_from</span><span class="p">:</span> <span class="nv">*id001</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="skip-ami-snapshots">
<span id="aws-ebs-snapshot-filters-skip-ami-snapshots"></span><h4>skip-ami-snapshots<a class="headerlink" href="#skip-ami-snapshots" title="Permalink to this headline">¶</a></h4>
<p>Filter to remove snapshots of AMIs from results</p>
<p>This filter is ‘true’ by default.</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<p>implicit with no parameters, ‘true’ by default</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">delete-ebs-stale-snapshots</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ebs-snapshot</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">age</span>
        <span class="nt">days</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">28</span>
        <span class="nt">op</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ge</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">skip-ami-snapshots</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<p>explicit with parameter</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">delete-snapshots</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ebs-snapshot</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">age</span>
        <span class="nt">days</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">28</span>
        <span class="nt">op</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ge</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">skip-ami-snapshots</span>
        <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">skip-ami-snapshots</span>
  <span class="nt">value</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="aws-ebs-snapshot-filters-unused">
<span id="id11"></span><h4>unused<a class="headerlink" href="#aws-ebs-snapshot-filters-unused" title="Permalink to this headline">¶</a></h4>
<p>Filters snapshots based on usage</p>
<p>true: snapshot is not used by launch-template, launch-config, or ami.</p>
<p>false: snapshot is being used by launch-template, launch-config, or ami.</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">snapshot-unused</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ebs-snapshot</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">unused</span>
        <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">unused</span>
  <span class="nt">value</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id12">
<h3>Actions<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-auto-tag-user"><span class="std std-ref">auto-tag-user</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ebs-snapshot-actions-copy"><span class="std std-ref">copy</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-copy-related-tag"><span class="std std-ref">copy-related-tag</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ebs-snapshot-actions-delete"><span class="std std-ref">delete</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-lambda"><span class="std std-ref">invoke-lambda</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-sfn"><span class="std std-ref">invoke-sfn</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-mark-for-op"><span class="std std-ref">mark-for-op</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-normalize-tag"><span class="std std-ref">normalize-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-notify"><span class="std std-ref">notify</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-post-finding"><span class="std std-ref">post-finding</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-put-metric"><span class="std std-ref">put-metric</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-remove-tag"><span class="std std-ref">remove-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-rename-tag"><span class="std std-ref">rename-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag"><span class="std std-ref">tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag-trim"><span class="std std-ref">tag-trim</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-webhook"><span class="std std-ref">webhook</span></a></p></li>
</ul>
</div></blockquote>
<div class="section" id="aws-ebs-snapshot-actions-copy">
<span id="id13"></span><h4>copy<a class="headerlink" href="#aws-ebs-snapshot-actions-copy" title="Permalink to this headline">¶</a></h4>
<p>Copy a snapshot across regions</p>
<p><a class="reference external" href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ebs-copy-snapshot.html">https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ebs-copy-snapshot.html</a></p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">copy-snapshot-east-west</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ebs-snapshot</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">age</span>
        <span class="nt">days</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">7</span>
        <span class="nt">op</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">le</span>
    <span class="nt">actions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">copy</span>
        <span class="nt">target_region</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">us-west-2</span>
        <span class="nt">target_key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">target_kms_key</span>
        <span class="nt">encrypted</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">encrypted</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">target_key</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">target_region</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">copy</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="aws-ebs-snapshot-actions-delete">
<span id="id14"></span><h4>delete<a class="headerlink" href="#aws-ebs-snapshot-actions-delete" title="Permalink to this headline">¶</a></h4>
<p>Deletes EBS snapshots</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">delete-stale-snapshots</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ebs-snapshot</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">age</span>
        <span class="nt">days</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">28</span>
        <span class="nt">op</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ge</span>
    <span class="nt">actions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">delete</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">skip-ami-snapshots</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">delete</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="aws-ec2">
<span id="id15"></span><h2>aws.ec2<a class="headerlink" href="#aws-ec2" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id16">
<h3>Filters<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-check-permissions"><span class="std std-ref">check-permissions</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-config-compliance"><span class="std std-ref">config-compliance</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ec2-filters-default-vpc"><span class="std std-ref">default-vpc</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ec2-filters-ebs"><span class="std std-ref">ebs</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ec2-filters-ephemeral"><span class="std std-ref">ephemeral</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-event"><span class="std std-ref">event</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-finding"><span class="std std-ref">finding</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-health-event"><span class="std std-ref">health-event</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ec2-filters-image"><span class="std std-ref">image</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ec2-filters-image-age"><span class="std std-ref">image-age</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ec2-filters-instance-age"><span class="std std-ref">instance-age</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ec2-filters-instance-attribute"><span class="std std-ref">instance-attribute</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ec2-filters-instance-uptime"><span class="std std-ref">instance-uptime</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-marked-for-op"><span class="std std-ref">marked-for-op</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-metrics"><span class="std std-ref">metrics</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-network-location"><span class="std std-ref">network-location</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-offhour"><span class="std std-ref">offhour</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-onhour"><span class="std std-ref">onhour</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-security-group"><span class="std std-ref">security-group</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ec2-filters-singleton"><span class="std std-ref">singleton</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ec2-filters-ssm"><span class="std std-ref">ssm</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ec2-filters-state-age"><span class="std std-ref">state-age</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-subnet"><span class="std std-ref">subnet</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-tag-count"><span class="std std-ref">tag-count</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ec2-filters-termination-protected"><span class="std std-ref">termination-protected</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ec2-filters-user-data"><span class="std std-ref">user-data</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-value"><span class="std std-ref">value</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-vpc"><span class="std std-ref">vpc</span></a></p></li>
</ul>
</div></blockquote>
<div class="section" id="default-vpc">
<span id="aws-ec2-filters-default-vpc"></span><h4>default-vpc<a class="headerlink" href="#default-vpc" title="Permalink to this headline">¶</a></h4>
<p>Matches if an ec2 database is in the default vpc</p>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">default-vpc</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="ebs">
<span id="aws-ec2-filters-ebs"></span><h4>ebs<a class="headerlink" href="#ebs" title="Permalink to this headline">¶</a></h4>
<p>EC2 instances with EBS backed volume</p>
<p>Filters EC2 instances with EBS backed storage devices (non ephemeral)</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2-encrypted-ebs-volumes</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ebs</span>
        <span class="nt">key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Encrypted</span>
        <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">default</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
  <span class="nt">key</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">op</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">eq</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">equal</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ne</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not-equal</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">gt</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">greater-than</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ge</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">gte</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">le</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lte</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lt</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">less-than</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">glob</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">regex</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">regex-case</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">in</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ni</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not-in</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">contains</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">difference</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">intersect</span>
  <span class="nt">operator</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">and</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">or</span>
  <span class="nt">skip-devices</span><span class="p">:</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ebs</span>
  <span class="nt">value</span><span class="p">:</span>
    <span class="nt">oneOf</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="s">&#39;null&#39;</span>
  <span class="nt">value_from</span><span class="p">:</span>
    <span class="nt">additionalProperties</span><span class="p">:</span> <span class="s">&#39;False&#39;</span>
    <span class="nt">properties</span><span class="p">:</span>
      <span class="nt">expr</span><span class="p">:</span>
        <span class="nt">oneOf</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
        <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
      <span class="nt">format</span><span class="p">:</span>
        <span class="nt">enum</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">csv</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">json</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">txt</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">csv2dict</span>
      <span class="nt">url</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">required</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">url</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
  <span class="nt">value_regex</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">value_type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">age</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">expiration</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">normalize</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">size</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cidr</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cidr_size</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">swap</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">resource_count</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">expr</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">unique_size</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">date</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="ephemeral">
<span id="aws-ec2-filters-ephemeral"></span><h4>ephemeral<a class="headerlink" href="#ephemeral" title="Permalink to this headline">¶</a></h4>
<p>EC2 instances with ephemeral storage</p>
<p>Filters EC2 instances that have ephemeral storage (an instance-store backed
root device)</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2-ephemeral-instances</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ephemeral</span>
</pre></div>
</div>
<p><a class="reference external" href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/InstanceStorage.html">http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/InstanceStorage.html</a></p>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ephemeral</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="image">
<span id="aws-ec2-filters-image"></span><h4>image<a class="headerlink" href="#image" title="Permalink to this headline">¶</a></h4>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">default</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
  <span class="nt">key</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">op</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">eq</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">equal</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ne</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not-equal</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">gt</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">greater-than</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ge</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">gte</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">le</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lte</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lt</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">less-than</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">glob</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">regex</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">regex-case</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">in</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ni</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not-in</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">contains</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">difference</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">intersect</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">image</span>
  <span class="nt">value</span><span class="p">:</span>
    <span class="nt">oneOf</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="s">&#39;null&#39;</span>
  <span class="nt">value_from</span><span class="p">:</span>
    <span class="nt">additionalProperties</span><span class="p">:</span> <span class="s">&#39;False&#39;</span>
    <span class="nt">properties</span><span class="p">:</span>
      <span class="nt">expr</span><span class="p">:</span>
        <span class="nt">oneOf</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
        <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
      <span class="nt">format</span><span class="p">:</span>
        <span class="nt">enum</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">csv</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">json</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">txt</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">csv2dict</span>
      <span class="nt">url</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">required</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">url</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
  <span class="nt">value_regex</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">value_type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">age</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">expiration</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">normalize</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">size</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cidr</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cidr_size</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">swap</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">resource_count</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">expr</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">unique_size</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">date</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="aws-ec2-filters-image-age">
<span id="id17"></span><h4>image-age<a class="headerlink" href="#aws-ec2-filters-image-age" title="Permalink to this headline">¶</a></h4>
<p>EC2 AMI age filter</p>
<p>Filters EC2 instances based on the age of their AMI image (in days)</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2-ancient-ami</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">image-age</span>
        <span class="nt">op</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ge</span>
        <span class="nt">days</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">90</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">days</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
  <span class="nt">op</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">eq</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">equal</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ne</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not-equal</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">gt</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">greater-than</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ge</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">gte</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">le</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lte</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lt</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">less-than</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">glob</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">regex</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">regex-case</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">in</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ni</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not-in</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">contains</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">difference</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">intersect</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">image-age</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="instance-age">
<span id="aws-ec2-filters-instance-age"></span><h4>instance-age<a class="headerlink" href="#instance-age" title="Permalink to this headline">¶</a></h4>
<p>Filters instances based on their age (in days)</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2-30-days-plus</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">instance-age</span>
        <span class="nt">op</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ge</span>
        <span class="nt">days</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">30</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">days</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
  <span class="nt">hours</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
  <span class="nt">minutes</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
  <span class="nt">op</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">eq</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">equal</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ne</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not-equal</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">gt</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">greater-than</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ge</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">gte</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">le</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lte</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lt</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">less-than</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">glob</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">regex</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">regex-case</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">in</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ni</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not-in</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">contains</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">difference</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">intersect</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">instance-age</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="instance-attribute">
<span id="aws-ec2-filters-instance-attribute"></span><h4>instance-attribute<a class="headerlink" href="#instance-attribute" title="Permalink to this headline">¶</a></h4>
<p>EC2 Instance Value FIlter on a given instance attribute.</p>
<p>Filters EC2 Instances with the given instance attribute</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2-unoptimized-ebs</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">instance-attribute</span>
        <span class="nt">attribute</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ebsOptimized</span>
        <span class="nt">key</span><span class="p">:</span> <span class="s">&quot;Value&quot;</span>
        <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">attribute</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">instanceType</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">kernel</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ramdisk</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">userData</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">disableApiTermination</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">instanceInitiatedShutdownBehavior</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">rootDeviceName</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">blockDeviceMapping</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">productCodes</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">sourceDestCheck</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">groupSet</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ebsOptimized</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">sriovNetSupport</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">enaSupport</span>
  <span class="nt">default</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
  <span class="nt">key</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">op</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">eq</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">equal</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ne</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not-equal</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">gt</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">greater-than</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ge</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">gte</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">le</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lte</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lt</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">less-than</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">glob</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">regex</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">regex-case</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">in</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ni</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not-in</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">contains</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">difference</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">intersect</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">instance-attribute</span>
  <span class="nt">value</span><span class="p">:</span>
    <span class="nt">oneOf</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="s">&#39;null&#39;</span>
  <span class="nt">value_from</span><span class="p">:</span>
    <span class="nt">additionalProperties</span><span class="p">:</span> <span class="s">&#39;False&#39;</span>
    <span class="nt">properties</span><span class="p">:</span>
      <span class="nt">expr</span><span class="p">:</span>
        <span class="nt">oneOf</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
        <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
      <span class="nt">format</span><span class="p">:</span>
        <span class="nt">enum</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">csv</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">json</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">txt</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">csv2dict</span>
      <span class="nt">url</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">required</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">url</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
  <span class="nt">value_regex</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">value_type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">age</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">expiration</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">normalize</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">size</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cidr</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cidr_size</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">swap</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">resource_count</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">expr</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">unique_size</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">date</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">attribute</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="instance-uptime">
<span id="aws-ec2-filters-instance-uptime"></span><h4>instance-uptime<a class="headerlink" href="#instance-uptime" title="Permalink to this headline">¶</a></h4>
<p>Automatically filter resources older than a given date.</p>
<p><strong>Deprecated</strong> use a value filter with <cite>value_type: age</cite> which can be
done on any attribute.</p>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">days</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
  <span class="nt">op</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">eq</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">equal</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ne</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not-equal</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">gt</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">greater-than</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ge</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">gte</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">le</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lte</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lt</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">less-than</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">glob</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">regex</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">regex-case</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">in</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ni</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not-in</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">contains</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">difference</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">intersect</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">instance-uptime</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="singleton">
<span id="aws-ec2-filters-singleton"></span><h4>singleton<a class="headerlink" href="#singleton" title="Permalink to this headline">¶</a></h4>
<p>EC2 instances without autoscaling or a recover alarm</p>
<p>Filters EC2 instances that are not members of an autoscaling group
and do not have Cloudwatch recover alarms.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2-recover-instances</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">singleton</span>
    <span class="nt">actions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">tag</span>
        <span class="nt">key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">problem</span>
        <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">instance is not resilient</span>
</pre></div>
</div>
<p><a class="reference external" href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-recover.html">https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-recover.html</a></p>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">singleton</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="ssm">
<span id="aws-ec2-filters-ssm"></span><h4>ssm<a class="headerlink" href="#ssm" title="Permalink to this headline">¶</a></h4>
<p>Filter ec2 instances by their ssm status information.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<p>Find ubuntu 18.04 instances are active with ssm.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2-ssm-check</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ssm</span>
        <span class="nt">key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">PingStatus</span>
        <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Online</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ssm</span>
        <span class="nt">key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">PlatformName</span>
        <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Ubuntu</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ssm</span>
        <span class="nt">key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">PlatformVersion</span>
        <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">18.04</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">default</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
  <span class="nt">key</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">op</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">eq</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">equal</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ne</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not-equal</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">gt</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">greater-than</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ge</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">gte</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">le</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lte</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lt</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">less-than</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">glob</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">regex</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">regex-case</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">in</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ni</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not-in</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">contains</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">difference</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">intersect</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ssm</span>
  <span class="nt">value</span><span class="p">:</span>
    <span class="nt">oneOf</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="s">&#39;null&#39;</span>
  <span class="nt">value_from</span><span class="p">:</span>
    <span class="nt">additionalProperties</span><span class="p">:</span> <span class="s">&#39;False&#39;</span>
    <span class="nt">properties</span><span class="p">:</span>
      <span class="nt">expr</span><span class="p">:</span>
        <span class="nt">oneOf</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
        <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
      <span class="nt">format</span><span class="p">:</span>
        <span class="nt">enum</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">csv</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">json</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">txt</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">csv2dict</span>
      <span class="nt">url</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">required</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">url</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
  <span class="nt">value_regex</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">value_type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">age</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">expiration</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">normalize</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">size</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cidr</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cidr_size</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">swap</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">resource_count</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">expr</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">unique_size</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">date</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="state-age">
<span id="aws-ec2-filters-state-age"></span><h4>state-age<a class="headerlink" href="#state-age" title="Permalink to this headline">¶</a></h4>
<p>Age an instance has been in the given state.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2-state-running-7-days</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">state-age</span>
        <span class="nt">op</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ge</span>
        <span class="nt">days</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">7</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">days</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
  <span class="nt">op</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">eq</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">equal</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ne</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not-equal</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">gt</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">greater-than</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ge</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">gte</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">le</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lte</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lt</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">less-than</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">glob</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">regex</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">regex-case</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">in</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ni</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not-in</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">contains</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">difference</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">intersect</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">state-age</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="termination-protected">
<span id="aws-ec2-filters-termination-protected"></span><h4>termination-protected<a class="headerlink" href="#termination-protected" title="Permalink to this headline">¶</a></h4>
<p>EC2 instances with <code class="docutils literal notranslate"><span class="pre">disableApiTermination</span></code> attribute set</p>
<p>Filters EC2 instances with <code class="docutils literal notranslate"><span class="pre">disableApiTermination</span></code> attribute set to true.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">termination-protection-enabled</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">termination-protected</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">termination-protection-NOT-enabled</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">not</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">termination-protected</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">termination-protected</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="user-data">
<span id="aws-ec2-filters-user-data"></span><h4>user-data<a class="headerlink" href="#user-data" title="Permalink to this headline">¶</a></h4>
<p>Filter on EC2 instances which have matching userdata.
Note: It is highly recommended to use regexes with the ?sm flags, since Custodian
uses re.match() and userdata spans multiple lines.</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2_userdata_stop</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">user-data</span>
        <span class="nt">op</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">regex</span>
        <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">(?smi).*password=</span>
    <span class="nt">actions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">stop</span>
</pre></div>
</div>
</div></blockquote>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">default</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
  <span class="nt">key</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">op</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">eq</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">equal</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ne</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not-equal</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">gt</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">greater-than</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ge</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">gte</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">le</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lte</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lt</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">less-than</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">glob</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">regex</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">regex-case</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">in</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ni</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not-in</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">contains</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">difference</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">intersect</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">user-data</span>
  <span class="nt">value</span><span class="p">:</span>
    <span class="nt">oneOf</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="s">&#39;null&#39;</span>
  <span class="nt">value_from</span><span class="p">:</span>
    <span class="nt">additionalProperties</span><span class="p">:</span> <span class="s">&#39;False&#39;</span>
    <span class="nt">properties</span><span class="p">:</span>
      <span class="nt">expr</span><span class="p">:</span>
        <span class="nt">oneOf</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
        <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
      <span class="nt">format</span><span class="p">:</span>
        <span class="nt">enum</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">csv</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">json</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">txt</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">csv2dict</span>
      <span class="nt">url</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">required</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">url</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
  <span class="nt">value_regex</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">value_type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">age</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">expiration</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">normalize</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">size</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cidr</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cidr_size</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">swap</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">resource_count</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">expr</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">unique_size</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">date</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id18">
<h3>Actions<a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-auto-tag-user"><span class="std std-ref">auto-tag-user</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ec2-actions-autorecover-alarm"><span class="std std-ref">autorecover-alarm</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-copy-related-tag"><span class="std std-ref">copy-related-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-lambda"><span class="std std-ref">invoke-lambda</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-sfn"><span class="std std-ref">invoke-sfn</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-mark-for-op"><span class="std std-ref">mark-for-op</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-modify-security-groups"><span class="std std-ref">modify-security-groups</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-normalize-tag"><span class="std std-ref">normalize-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-notify"><span class="std std-ref">notify</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-post-finding"><span class="std std-ref">post-finding</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ec2-actions-propagate-spot-tags"><span class="std std-ref">propagate-spot-tags</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-put-metric"><span class="std std-ref">put-metric</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ec2-actions-reboot"><span class="std std-ref">reboot</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-remove-tag"><span class="std std-ref">remove-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-rename-tag"><span class="std std-ref">rename-tag</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ec2-actions-resize"><span class="std std-ref">resize</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ec2-actions-send-command"><span class="std std-ref">send-command</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ec2-actions-set-instance-profile"><span class="std std-ref">set-instance-profile</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ec2-actions-snapshot"><span class="std std-ref">snapshot</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ec2-actions-start"><span class="std std-ref">start</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ec2-actions-stop"><span class="std std-ref">stop</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag"><span class="std std-ref">tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag-trim"><span class="std std-ref">tag-trim</span></a></p></li>
<li><p><a class="reference internal" href="#aws-ec2-actions-terminate"><span class="std std-ref">terminate</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-webhook"><span class="std std-ref">webhook</span></a></p></li>
</ul>
</div></blockquote>
<div class="section" id="autorecover-alarm">
<span id="aws-ec2-actions-autorecover-alarm"></span><h4>autorecover-alarm<a class="headerlink" href="#autorecover-alarm" title="Permalink to this headline">¶</a></h4>
<p>Adds a cloudwatch metric alarm to recover an EC2 instance.</p>
<p>This action takes effect on instances that are NOT part
of an ASG.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2-autorecover-alarm</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">singleton</span>
    <span class="nt">actions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">autorecover-alarm</span>
</pre></div>
</div>
<p><a class="reference external" href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-recover.html">https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-recover.html</a></p>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">autorecover-alarm</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="propagate-spot-tags">
<span id="aws-ec2-actions-propagate-spot-tags"></span><h4>propagate-spot-tags<a class="headerlink" href="#propagate-spot-tags" title="Permalink to this headline">¶</a></h4>
<p>Propagate Tags that are set at Spot Request level to EC2 instances.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2-spot-instances</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">State.Name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">pending</span>
      <span class="p p-Indicator">-</span> <span class="nt">instanceLifecycle</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">spot</span>
    <span class="nt">actions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">propagate-spot-tags</span>
        <span class="nt">only_tags</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Name</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">BillingTag</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">only_tags</span><span class="p">:</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">propagate-spot-tags</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="reboot">
<span id="aws-ec2-actions-reboot"></span><h4>reboot<a class="headerlink" href="#reboot" title="Permalink to this headline">¶</a></h4>
<p>reboots a previously running EC2 instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2-reboot-instances</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
    <span class="nt">query</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">instance-state-name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">running</span>
    <span class="nt">actions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">reboot</span>
</pre></div>
</div>
<p><a class="reference external" href="http://docs.aws.amazon.com/cli/latest/reference/ec2/reboot-instances.html">http://docs.aws.amazon.com/cli/latest/reference/ec2/reboot-instances.html</a></p>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">reboot</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="resize">
<span id="aws-ec2-actions-resize"></span><h4>resize<a class="headerlink" href="#resize" title="Permalink to this headline">¶</a></h4>
<p>Change an instance’s size.</p>
<p>An instance can only be resized when its stopped, this action
can optionally restart an instance if needed to effect the instance
type change. Instances are always left in the run state they were
found in.</p>
<p>There are a few caveats to be aware of, instance resizing
needs to maintain compatibility for architecture, virtualization type
hvm/pv, and ebs optimization at minimum.</p>
<p><a class="reference external" href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-resize.html">http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-resize.html</a></p>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">default</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">restart</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">resize</span>
  <span class="nt">type-map</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="send-command">
<span id="aws-ec2-actions-send-command"></span><h4>send-command<a class="headerlink" href="#send-command" title="Permalink to this headline">¶</a></h4>
<p>Run an SSM Automation Document on an instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<p>Find ubuntu 18.04 instances are active with ssm.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2-osquery-install</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ssm</span>
        <span class="nt">key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">PingStatus</span>
        <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Online</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ssm</span>
        <span class="nt">key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">PlatformName</span>
        <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Ubuntu</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ssm</span>
        <span class="nt">key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">PlatformVersion</span>
        <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">18.04</span>
    <span class="nt">actions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">send-command</span>
        <span class="nt">command</span><span class="p">:</span>
          <span class="nt">DocumentName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AWS-RunShellScript</span>
          <span class="nt">Parameters</span><span class="p">:</span>
            <span class="nt">commands</span><span class="p">:</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">wget https://pkg.osquery.io/deb/osquery_3.3.0_1.linux.amd64.deb</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">dpkg -i osquery_3.3.0_1.linux.amd64.deb</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">command</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">send-command</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">command</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="set-instance-profile">
<span id="aws-ec2-actions-set-instance-profile"></span><h4>set-instance-profile<a class="headerlink" href="#set-instance-profile" title="Permalink to this headline">¶</a></h4>
<p>Sets (add, modify, remove) the instance profile for a running EC2 instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">set-default-instance-profile</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">IamInstanceProfile</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">absent</span>
    <span class="nt">actions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">set-instance-profile</span>
        <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">default</span>
</pre></div>
</div>
<p><a class="reference external" href="https://docs.aws.amazon.com/cli/latest/reference/ec2/associate-iam-instance-profile.html">https://docs.aws.amazon.com/cli/latest/reference/ec2/associate-iam-instance-profile.html</a>
<a class="reference external" href="https://docs.aws.amazon.com/cli/latest/reference/ec2/disassociate-iam-instance-profile.html">https://docs.aws.amazon.com/cli/latest/reference/ec2/disassociate-iam-instance-profile.html</a></p>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">set-instance-profile</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="aws-ec2-actions-snapshot">
<span id="id19"></span><h4>snapshot<a class="headerlink" href="#aws-ec2-actions-snapshot" title="Permalink to this headline">¶</a></h4>
<p>Snapshots volumes attached to an EC2 instance</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2-snapshots</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
    <span class="nt">actions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">snapshot</span>
        <span class="nt">copy-tags</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Name</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">copy-tags</span><span class="p">:</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
  <span class="nt">copy-volume-tags</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">exclude-boot</span><span class="p">:</span>
    <span class="nt">default</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">snapshot</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="start">
<span id="aws-ec2-actions-start"></span><h4>start<a class="headerlink" href="#start" title="Permalink to this headline">¶</a></h4>
<p>Starts a previously stopped EC2 instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2-start-stopped-instances</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
    <span class="nt">query</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">instance-state-name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">stopped</span>
    <span class="nt">actions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">start</span>
</pre></div>
</div>
<p><a class="reference external" href="http://docs.aws.amazon.com/cli/latest/reference/ec2/start-instances.html">http://docs.aws.amazon.com/cli/latest/reference/ec2/start-instances.html</a></p>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">start</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="stop">
<span id="aws-ec2-actions-stop"></span><h4>stop<a class="headerlink" href="#stop" title="Permalink to this headline">¶</a></h4>
<p>Stops a running EC2 instances</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2-stop-running-instances</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
    <span class="nt">query</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">instance-state-name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">running</span>
    <span class="nt">actions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">stop</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">terminate-ephemeral</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">stop</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="terminate">
<span id="aws-ec2-actions-terminate"></span><h4>terminate<a class="headerlink" href="#terminate" title="Permalink to this headline">¶</a></h4>
<p>Terminate a set of instances.</p>
<p>While ec2 offers a bulk delete api, any given instance can be configured
with api deletion termination protection, so we can’t use the bulk call
reliabily, we need to process the instances individually. Additionally
If we’re configured with ‘force’ then we’ll turn off instance termination
protection.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2-process-termination</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">marked-for-op</span>
        <span class="nt">op</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">terminate</span>
    <span class="nt">actions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">terminate</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">force</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">terminate</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="aws-ec2-reserved">
<span id="id20"></span><h2>aws.ec2-reserved<a class="headerlink" href="#aws-ec2-reserved" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id21">
<h3>Filters<a class="headerlink" href="#id21" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-event"><span class="std std-ref">event</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-finding"><span class="std std-ref">finding</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-marked-for-op"><span class="std std-ref">marked-for-op</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-tag-count"><span class="std std-ref">tag-count</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-value"><span class="std std-ref">value</span></a></p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="id22">
<h3>Actions<a class="headerlink" href="#id22" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-auto-tag-user"><span class="std std-ref">auto-tag-user</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-copy-related-tag"><span class="std std-ref">copy-related-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-lambda"><span class="std std-ref">invoke-lambda</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-sfn"><span class="std std-ref">invoke-sfn</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-mark-for-op"><span class="std std-ref">mark-for-op</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-normalize-tag"><span class="std std-ref">normalize-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-notify"><span class="std std-ref">notify</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-post-finding"><span class="std std-ref">post-finding</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-put-metric"><span class="std std-ref">put-metric</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-remove-tag"><span class="std std-ref">remove-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-rename-tag"><span class="std std-ref">rename-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag"><span class="std std-ref">tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag-trim"><span class="std std-ref">tag-trim</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-webhook"><span class="std std-ref">webhook</span></a></p></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="aws-eni">
<span id="id23"></span><h2>aws.eni<a class="headerlink" href="#aws-eni" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id24">
<h3>Filters<a class="headerlink" href="#id24" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-config-compliance"><span class="std std-ref">config-compliance</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-event"><span class="std std-ref">event</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-finding"><span class="std std-ref">finding</span></a></p></li>
<li><p><a class="reference internal" href="#aws-eni-filters-flow-logs"><span class="std std-ref">flow-logs</span></a></p></li>
<li><p><a class="reference internal" href="#aws-eni-filters-json-diff"><span class="std std-ref">json-diff</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-marked-for-op"><span class="std std-ref">marked-for-op</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-network-location"><span class="std std-ref">network-location</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-security-group"><span class="std std-ref">security-group</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-subnet"><span class="std std-ref">subnet</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-tag-count"><span class="std std-ref">tag-count</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-value"><span class="std std-ref">value</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-vpc"><span class="std std-ref">vpc</span></a></p></li>
</ul>
</div></blockquote>
<div class="section" id="flow-logs">
<span id="aws-eni-filters-flow-logs"></span><h4>flow-logs<a class="headerlink" href="#flow-logs" title="Permalink to this headline">¶</a></h4>
<p>Are flow logs enabled on the resource.</p>
<p>ie to find all vpcs with flows logs disabled we can do this</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">flow-logs-enabled</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vpc</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">flow-logs</span>
</pre></div>
</div>
<p>or to find all vpcs with flow logs but that don’t match a
particular configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">flow-mis-configured</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vpc</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">not</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">flow-logs</span>
          <span class="nt">enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
          <span class="nt">set-op</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">or</span>
          <span class="nt">op</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">equal</span>
          <span class="c1"># equality operator applies to following keys</span>
          <span class="nt">traffic-type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">all</span>
          <span class="nt">status</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">active</span>
          <span class="nt">log-group</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vpc-logs</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">deliver-status</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">success</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">failure</span>
  <span class="nt">destination</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">destination-type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">s3</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cloud-watch-logs</span>
  <span class="nt">enabled</span><span class="p">:</span>
    <span class="nt">default</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">log-group</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">op</span><span class="p">:</span>
    <span class="nt">default</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">equal</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">equal</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not-equal</span>
  <span class="nt">set-op</span><span class="p">:</span>
    <span class="nt">default</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">or</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">or</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">and</span>
  <span class="nt">status</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">active</span>
  <span class="nt">traffic-type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">accept</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">reject</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">all</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">flow-logs</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="json-diff">
<span id="aws-eni-filters-json-diff"></span><h4>json-diff<a class="headerlink" href="#json-diff" title="Permalink to this headline">¶</a></h4>
<p>Compute the diff from the current resource to a previous version.</p>
<p>A resource matches the filter if a diff exists between the current
resource and the selected revision.</p>
<p>Utilizes config as a resource revision database.</p>
<p>Revisions can be selected by date, against the previous version, and
against a locked version (requires use of is-locked filter).</p>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">selector</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">previous</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">date</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">locked</span>
  <span class="nt">selector_value</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">json-diff</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id25">
<h3>Actions<a class="headerlink" href="#id25" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-auto-tag-user"><span class="std std-ref">auto-tag-user</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-copy-related-tag"><span class="std std-ref">copy-related-tag</span></a></p></li>
<li><p><a class="reference internal" href="#aws-eni-actions-delete"><span class="std std-ref">delete</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-lambda"><span class="std std-ref">invoke-lambda</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-sfn"><span class="std std-ref">invoke-sfn</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-mark-for-op"><span class="std std-ref">mark-for-op</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-modify-security-groups"><span class="std std-ref">modify-security-groups</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-normalize-tag"><span class="std std-ref">normalize-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-notify"><span class="std std-ref">notify</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-post-finding"><span class="std std-ref">post-finding</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-put-metric"><span class="std std-ref">put-metric</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-remove-tag"><span class="std std-ref">remove-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-rename-tag"><span class="std std-ref">rename-tag</span></a></p></li>
<li><p><a class="reference internal" href="#aws-eni-actions-set-flow-log"><span class="std std-ref">set-flow-log</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag"><span class="std std-ref">tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag-trim"><span class="std std-ref">tag-trim</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-webhook"><span class="std std-ref">webhook</span></a></p></li>
</ul>
</div></blockquote>
<div class="section" id="aws-eni-actions-delete">
<span id="id26"></span><h4>delete<a class="headerlink" href="#aws-eni-actions-delete" title="Permalink to this headline">¶</a></h4>
<p>Delete a network interface.</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mark-orphaned-enis</span>
    <span class="nt">comment</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Flag abandoned Lambda VPC ENIs for deletion</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">eni</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">Status</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">available</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">value</span>
        <span class="nt">op</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">glob</span>
        <span class="nt">key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Description</span>
        <span class="nt">value</span><span class="p">:</span> <span class="s">&quot;AWS</span><span class="nv"> </span><span class="s">Lambda</span><span class="nv"> </span><span class="s">VPC</span><span class="nv"> </span><span class="s">ENI*&quot;</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;tag:custodian_status&quot;</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">absent</span>
    <span class="nt">actions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mark-for-op</span>
        <span class="nt">tag</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">custodian_status</span>
        <span class="nt">msg</span><span class="p">:</span> <span class="s">&quot;Orphaned</span><span class="nv"> </span><span class="s">Lambda</span><span class="nv"> </span><span class="s">VPC</span><span class="nv"> </span><span class="s">ENI:</span><span class="nv"> </span><span class="s">{op}@{action_date}&quot;</span>
        <span class="nt">op</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">delete</span>
        <span class="nt">days</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>

  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">delete-marked-enis</span>
    <span class="nt">comment</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Delete flagged ENIs that have not been cleaned up naturally</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">eni</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">marked-for-op</span>
        <span class="nt">tag</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">custodian_status</span>
        <span class="nt">op</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">delete</span>
    <span class="nt">actions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">delete</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">delete</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="set-flow-log">
<span id="aws-eni-actions-set-flow-log"></span><h4>set-flow-log<a class="headerlink" href="#set-flow-log" title="Permalink to this headline">¶</a></h4>
<p>Create flow logs for a network resource</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vpc-enable-flow-logs</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vpc</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">flow-logs</span>
        <span class="nt">enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="nt">actions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">set-flow-log</span>
        <span class="nt">DeliverLogsPermissionArn</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">arn:iam:role</span>
        <span class="nt">LogGroupName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/custodian/vpc/flowlogs/</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">DeliverLogsPermissionArn</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">LogDestination</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">LogDestinationType</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">s3</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cloud-watch-logs</span>
  <span class="nt">LogGroupName</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">TrafficType</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ACCEPT</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">REJECT</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ALL</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">state</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">set-flow-log</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="aws-internet-gateway">
<span id="id27"></span><h2>aws.internet-gateway<a class="headerlink" href="#aws-internet-gateway" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id28">
<h3>Filters<a class="headerlink" href="#id28" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-config-compliance"><span class="std std-ref">config-compliance</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-event"><span class="std std-ref">event</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-finding"><span class="std std-ref">finding</span></a></p></li>
<li><p><a class="reference internal" href="#aws-internet-gateway-filters-json-diff"><span class="std std-ref">json-diff</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-marked-for-op"><span class="std std-ref">marked-for-op</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-tag-count"><span class="std std-ref">tag-count</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-value"><span class="std std-ref">value</span></a></p></li>
</ul>
</div></blockquote>
<div class="section" id="aws-internet-gateway-filters-json-diff">
<span id="id29"></span><h4>json-diff<a class="headerlink" href="#aws-internet-gateway-filters-json-diff" title="Permalink to this headline">¶</a></h4>
<p>Compute the diff from the current resource to a previous version.</p>
<p>A resource matches the filter if a diff exists between the current
resource and the selected revision.</p>
<p>Utilizes config as a resource revision database.</p>
<p>Revisions can be selected by date, against the previous version, and
against a locked version (requires use of is-locked filter).</p>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">selector</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">previous</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">date</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">locked</span>
  <span class="nt">selector_value</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">json-diff</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id30">
<h3>Actions<a class="headerlink" href="#id30" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-auto-tag-user"><span class="std std-ref">auto-tag-user</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-copy-related-tag"><span class="std std-ref">copy-related-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-lambda"><span class="std std-ref">invoke-lambda</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-sfn"><span class="std std-ref">invoke-sfn</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-mark-for-op"><span class="std std-ref">mark-for-op</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-normalize-tag"><span class="std std-ref">normalize-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-notify"><span class="std std-ref">notify</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-post-finding"><span class="std std-ref">post-finding</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-put-metric"><span class="std std-ref">put-metric</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-remove-tag"><span class="std std-ref">remove-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-rename-tag"><span class="std std-ref">rename-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag"><span class="std std-ref">tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag-trim"><span class="std std-ref">tag-trim</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-webhook"><span class="std std-ref">webhook</span></a></p></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="aws-key-pair">
<span id="id31"></span><h2>aws.key-pair<a class="headerlink" href="#aws-key-pair" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id32">
<h3>Filters<a class="headerlink" href="#id32" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-event"><span class="std std-ref">event</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-finding"><span class="std std-ref">finding</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-value"><span class="std std-ref">value</span></a></p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="id33">
<h3>Actions<a class="headerlink" href="#id33" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-lambda"><span class="std std-ref">invoke-lambda</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-sfn"><span class="std std-ref">invoke-sfn</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-notify"><span class="std std-ref">notify</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-post-finding"><span class="std std-ref">post-finding</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-put-metric"><span class="std std-ref">put-metric</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-webhook"><span class="std std-ref">webhook</span></a></p></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="aws-launch-template-version">
<span id="id34"></span><h2>aws.launch-template-version<a class="headerlink" href="#aws-launch-template-version" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id35">
<h3>Filters<a class="headerlink" href="#id35" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-event"><span class="std std-ref">event</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-finding"><span class="std std-ref">finding</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-marked-for-op"><span class="std std-ref">marked-for-op</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-tag-count"><span class="std std-ref">tag-count</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-value"><span class="std std-ref">value</span></a></p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="id36">
<h3>Actions<a class="headerlink" href="#id36" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-auto-tag-user"><span class="std std-ref">auto-tag-user</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-copy-related-tag"><span class="std std-ref">copy-related-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-lambda"><span class="std std-ref">invoke-lambda</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-sfn"><span class="std std-ref">invoke-sfn</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-mark-for-op"><span class="std std-ref">mark-for-op</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-normalize-tag"><span class="std std-ref">normalize-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-notify"><span class="std std-ref">notify</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-post-finding"><span class="std std-ref">post-finding</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-put-metric"><span class="std std-ref">put-metric</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-remove-tag"><span class="std std-ref">remove-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-rename-tag"><span class="std std-ref">rename-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag"><span class="std std-ref">tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag-trim"><span class="std std-ref">tag-trim</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-webhook"><span class="std std-ref">webhook</span></a></p></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="aws-nat-gateway">
<span id="id37"></span><h2>aws.nat-gateway<a class="headerlink" href="#aws-nat-gateway" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id38">
<h3>Filters<a class="headerlink" href="#id38" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-event"><span class="std std-ref">event</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-finding"><span class="std std-ref">finding</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-marked-for-op"><span class="std std-ref">marked-for-op</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-tag-count"><span class="std std-ref">tag-count</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-value"><span class="std std-ref">value</span></a></p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="id39">
<h3>Actions<a class="headerlink" href="#id39" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-auto-tag-user"><span class="std std-ref">auto-tag-user</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-copy-related-tag"><span class="std std-ref">copy-related-tag</span></a></p></li>
<li><p><a class="reference internal" href="#aws-nat-gateway-actions-delete"><span class="std std-ref">delete</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-lambda"><span class="std std-ref">invoke-lambda</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-sfn"><span class="std std-ref">invoke-sfn</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-mark-for-op"><span class="std std-ref">mark-for-op</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-normalize-tag"><span class="std std-ref">normalize-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-notify"><span class="std std-ref">notify</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-post-finding"><span class="std std-ref">post-finding</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-put-metric"><span class="std std-ref">put-metric</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-remove-tag"><span class="std std-ref">remove-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-rename-tag"><span class="std std-ref">rename-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag"><span class="std std-ref">tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag-trim"><span class="std std-ref">tag-trim</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-webhook"><span class="std std-ref">webhook</span></a></p></li>
</ul>
</div></blockquote>
<div class="section" id="aws-nat-gateway-actions-delete">
<span id="id40"></span><h4>delete<a class="headerlink" href="#aws-nat-gateway-actions-delete" title="Permalink to this headline">¶</a></h4>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">delete</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="aws-network-acl">
<span id="id41"></span><h2>aws.network-acl<a class="headerlink" href="#aws-network-acl" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id42">
<h3>Filters<a class="headerlink" href="#id42" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-config-compliance"><span class="std std-ref">config-compliance</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-event"><span class="std std-ref">event</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-finding"><span class="std std-ref">finding</span></a></p></li>
<li><p><a class="reference internal" href="#aws-network-acl-filters-json-diff"><span class="std std-ref">json-diff</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-marked-for-op"><span class="std std-ref">marked-for-op</span></a></p></li>
<li><p><a class="reference internal" href="#aws-network-acl-filters-s3-cidr"><span class="std std-ref">s3-cidr</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-subnet"><span class="std std-ref">subnet</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-tag-count"><span class="std std-ref">tag-count</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-value"><span class="std std-ref">value</span></a></p></li>
</ul>
</div></blockquote>
<div class="section" id="aws-network-acl-filters-json-diff">
<span id="id43"></span><h4>json-diff<a class="headerlink" href="#aws-network-acl-filters-json-diff" title="Permalink to this headline">¶</a></h4>
<p>Compute the diff from the current resource to a previous version.</p>
<p>A resource matches the filter if a diff exists between the current
resource and the selected revision.</p>
<p>Utilizes config as a resource revision database.</p>
<p>Revisions can be selected by date, against the previous version, and
against a locked version (requires use of is-locked filter).</p>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">selector</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">previous</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">date</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">locked</span>
  <span class="nt">selector_value</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">json-diff</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="s3-cidr">
<span id="aws-network-acl-filters-s3-cidr"></span><h4>s3-cidr<a class="headerlink" href="#s3-cidr" title="Permalink to this headline">¶</a></h4>
<p>Filter network acls by those that allow access to s3 cidrs.</p>
<p>Defaults to filtering those nacls that do not allow s3 communication.</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p>Find all nacls that do not allow communication with s3.</p>
</dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">s3-not-allowed-nacl</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">network-acl</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">s3-cidr</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">egress</span><span class="p">:</span>
    <span class="nt">default</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">ingress</span><span class="p">:</span>
    <span class="nt">default</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">present</span><span class="p">:</span>
    <span class="nt">default</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">s3-cidr</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id44">
<h3>Actions<a class="headerlink" href="#id44" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-auto-tag-user"><span class="std std-ref">auto-tag-user</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-copy-related-tag"><span class="std std-ref">copy-related-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-lambda"><span class="std std-ref">invoke-lambda</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-sfn"><span class="std std-ref">invoke-sfn</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-mark-for-op"><span class="std std-ref">mark-for-op</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-normalize-tag"><span class="std std-ref">normalize-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-notify"><span class="std std-ref">notify</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-post-finding"><span class="std std-ref">post-finding</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-put-metric"><span class="std std-ref">put-metric</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-remove-tag"><span class="std std-ref">remove-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-rename-tag"><span class="std std-ref">rename-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag"><span class="std std-ref">tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag-trim"><span class="std std-ref">tag-trim</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-webhook"><span class="std std-ref">webhook</span></a></p></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="aws-network-addr">
<span id="id45"></span><h2>aws.network-addr<a class="headerlink" href="#aws-network-addr" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id46">
<h3>Filters<a class="headerlink" href="#id46" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-config-compliance"><span class="std std-ref">config-compliance</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-event"><span class="std std-ref">event</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-finding"><span class="std std-ref">finding</span></a></p></li>
<li><p><a class="reference internal" href="#aws-network-addr-filters-json-diff"><span class="std std-ref">json-diff</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-marked-for-op"><span class="std std-ref">marked-for-op</span></a></p></li>
<li><p><a class="reference internal" href="#aws-network-addr-filters-shield-enabled"><span class="std std-ref">shield-enabled</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-tag-count"><span class="std std-ref">tag-count</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-value"><span class="std std-ref">value</span></a></p></li>
</ul>
</div></blockquote>
<div class="section" id="aws-network-addr-filters-json-diff">
<span id="id47"></span><h4>json-diff<a class="headerlink" href="#aws-network-addr-filters-json-diff" title="Permalink to this headline">¶</a></h4>
<p>Compute the diff from the current resource to a previous version.</p>
<p>A resource matches the filter if a diff exists between the current
resource and the selected revision.</p>
<p>Utilizes config as a resource revision database.</p>
<p>Revisions can be selected by date, against the previous version, and
against a locked version (requires use of is-locked filter).</p>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">selector</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">previous</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">date</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">locked</span>
  <span class="nt">selector_value</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">json-diff</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="shield-enabled">
<span id="aws-network-addr-filters-shield-enabled"></span><h4>shield-enabled<a class="headerlink" href="#shield-enabled" title="Permalink to this headline">¶</a></h4>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">state</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">shield-enabled</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id48">
<h3>Actions<a class="headerlink" href="#id48" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-auto-tag-user"><span class="std std-ref">auto-tag-user</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-copy-related-tag"><span class="std std-ref">copy-related-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-lambda"><span class="std std-ref">invoke-lambda</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-sfn"><span class="std std-ref">invoke-sfn</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-mark-for-op"><span class="std std-ref">mark-for-op</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-normalize-tag"><span class="std std-ref">normalize-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-notify"><span class="std std-ref">notify</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-post-finding"><span class="std std-ref">post-finding</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-put-metric"><span class="std std-ref">put-metric</span></a></p></li>
<li><p><a class="reference internal" href="#aws-network-addr-actions-release"><span class="std std-ref">release</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-remove-tag"><span class="std std-ref">remove-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-rename-tag"><span class="std std-ref">rename-tag</span></a></p></li>
<li><p><a class="reference internal" href="#aws-network-addr-actions-set-shield"><span class="std std-ref">set-shield</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag"><span class="std std-ref">tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag-trim"><span class="std std-ref">tag-trim</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-webhook"><span class="std std-ref">webhook</span></a></p></li>
</ul>
</div></blockquote>
<div class="section" id="release">
<span id="aws-network-addr-actions-release"></span><h4>release<a class="headerlink" href="#release" title="Permalink to this headline">¶</a></h4>
<p>Action to release elastic IP address(es)</p>
<p>Use the force option to cause any attached elastic IPs to
also be released.  Otherwise, only unattached elastic IPs
will be released.</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">release-network-addr</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">network-addr</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">AllocationId</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">...</span>
    <span class="nt">actions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">release</span>
        <span class="nt">force</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">force</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">release</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="set-shield">
<span id="aws-network-addr-actions-set-shield"></span><h4>set-shield<a class="headerlink" href="#set-shield" title="Permalink to this headline">¶</a></h4>
<p>Enable shield protection on applicable resource.</p>
<p>setting <cite>sync</cite> parameter will also clear out stale shield protections
for resources that no longer exist.</p>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">state</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">sync</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">set-shield</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="aws-peering-connection">
<span id="id49"></span><h2>aws.peering-connection<a class="headerlink" href="#aws-peering-connection" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id50">
<h3>Filters<a class="headerlink" href="#id50" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="#aws-peering-connection-filters-cross-account"><span class="std std-ref">cross-account</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-event"><span class="std std-ref">event</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-finding"><span class="std std-ref">finding</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-marked-for-op"><span class="std std-ref">marked-for-op</span></a></p></li>
<li><p><a class="reference internal" href="#aws-peering-connection-filters-missing-route"><span class="std std-ref">missing-route</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-tag-count"><span class="std std-ref">tag-count</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-value"><span class="std std-ref">value</span></a></p></li>
</ul>
</div></blockquote>
<div class="section" id="aws-peering-connection-filters-cross-account">
<span id="id51"></span><h4>cross-account<a class="headerlink" href="#aws-peering-connection-filters-cross-account" title="Permalink to this headline">¶</a></h4>
<p>Check a resource’s embedded iam policy for cross account access.</p>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cross-account</span>
  <span class="nt">whitelist</span><span class="p">:</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
  <span class="nt">whitelist_from</span><span class="p">:</span>
    <span class="nt">additionalProperties</span><span class="p">:</span> <span class="s">&#39;False&#39;</span>
    <span class="nt">properties</span><span class="p">:</span>
      <span class="nt">expr</span><span class="p">:</span>
        <span class="nt">oneOf</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
        <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
      <span class="nt">format</span><span class="p">:</span>
        <span class="nt">enum</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">csv</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">json</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">txt</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">csv2dict</span>
      <span class="nt">url</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">required</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">url</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="missing-route">
<span id="aws-peering-connection-filters-missing-route"></span><h4>missing-route<a class="headerlink" href="#missing-route" title="Permalink to this headline">¶</a></h4>
<p>Return peers which are missing a route in route tables.</p>
<p>If the peering connection is between two vpcs in the same account,
the connection is returned unless it is in present route tables in
each vpc.</p>
<p>If the peering connection is between accounts, then the local vpc’s
route table is checked.</p>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">missing-route</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id52">
<h3>Actions<a class="headerlink" href="#id52" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-auto-tag-user"><span class="std std-ref">auto-tag-user</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-copy-related-tag"><span class="std std-ref">copy-related-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-lambda"><span class="std std-ref">invoke-lambda</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-sfn"><span class="std std-ref">invoke-sfn</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-mark-for-op"><span class="std std-ref">mark-for-op</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-normalize-tag"><span class="std std-ref">normalize-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-notify"><span class="std std-ref">notify</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-post-finding"><span class="std std-ref">post-finding</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-put-metric"><span class="std std-ref">put-metric</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-remove-tag"><span class="std std-ref">remove-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-rename-tag"><span class="std std-ref">rename-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag"><span class="std std-ref">tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag-trim"><span class="std std-ref">tag-trim</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-webhook"><span class="std std-ref">webhook</span></a></p></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="aws-route-table">
<span id="id53"></span><h2>aws.route-table<a class="headerlink" href="#aws-route-table" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id54">
<h3>Filters<a class="headerlink" href="#id54" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-event"><span class="std std-ref">event</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-finding"><span class="std std-ref">finding</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-marked-for-op"><span class="std std-ref">marked-for-op</span></a></p></li>
<li><p><a class="reference internal" href="#aws-route-table-filters-route"><span class="std std-ref">route</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-subnet"><span class="std std-ref">subnet</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-tag-count"><span class="std std-ref">tag-count</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-value"><span class="std std-ref">value</span></a></p></li>
</ul>
</div></blockquote>
<div class="section" id="route">
<span id="aws-route-table-filters-route"></span><h4>route<a class="headerlink" href="#route" title="Permalink to this headline">¶</a></h4>
<p>Filter a route table by its routes’ attributes.</p>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">default</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
  <span class="nt">key</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">op</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">eq</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">equal</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ne</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not-equal</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">gt</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">greater-than</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ge</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">gte</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">le</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lte</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lt</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">less-than</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">glob</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">regex</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">regex-case</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">in</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ni</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not-in</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">contains</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">difference</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">intersect</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">route</span>
  <span class="nt">value</span><span class="p">:</span>
    <span class="nt">oneOf</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="s">&#39;null&#39;</span>
  <span class="nt">value_from</span><span class="p">:</span>
    <span class="nt">additionalProperties</span><span class="p">:</span> <span class="s">&#39;False&#39;</span>
    <span class="nt">properties</span><span class="p">:</span>
      <span class="nt">expr</span><span class="p">:</span>
        <span class="nt">oneOf</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
        <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
      <span class="nt">format</span><span class="p">:</span>
        <span class="nt">enum</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">csv</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">json</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">txt</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">csv2dict</span>
      <span class="nt">url</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">required</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">url</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
  <span class="nt">value_regex</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">value_type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">age</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">expiration</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">normalize</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">size</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cidr</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cidr_size</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">swap</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">resource_count</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">expr</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">unique_size</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">date</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id55">
<h3>Actions<a class="headerlink" href="#id55" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-auto-tag-user"><span class="std std-ref">auto-tag-user</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-copy-related-tag"><span class="std std-ref">copy-related-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-lambda"><span class="std std-ref">invoke-lambda</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-sfn"><span class="std std-ref">invoke-sfn</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-mark-for-op"><span class="std std-ref">mark-for-op</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-normalize-tag"><span class="std std-ref">normalize-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-notify"><span class="std std-ref">notify</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-post-finding"><span class="std std-ref">post-finding</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-put-metric"><span class="std std-ref">put-metric</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-remove-tag"><span class="std std-ref">remove-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-rename-tag"><span class="std std-ref">rename-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag"><span class="std std-ref">tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag-trim"><span class="std std-ref">tag-trim</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-webhook"><span class="std std-ref">webhook</span></a></p></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="aws-security-group">
<span id="id56"></span><h2>aws.security-group<a class="headerlink" href="#aws-security-group" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id57">
<h3>Filters<a class="headerlink" href="#id57" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-config-compliance"><span class="std std-ref">config-compliance</span></a></p></li>
<li><p><a class="reference internal" href="#aws-security-group-filters-default-vpc"><span class="std std-ref">default-vpc</span></a></p></li>
<li><p><a class="reference internal" href="#aws-security-group-filters-diff"><span class="std std-ref">diff</span></a></p></li>
<li><p><a class="reference internal" href="#aws-security-group-filters-egress"><span class="std std-ref">egress</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-event"><span class="std std-ref">event</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-finding"><span class="std std-ref">finding</span></a></p></li>
<li><p><a class="reference internal" href="#aws-security-group-filters-ingress"><span class="std std-ref">ingress</span></a></p></li>
<li><p><a class="reference internal" href="#aws-security-group-filters-json-diff"><span class="std std-ref">json-diff</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-marked-for-op"><span class="std std-ref">marked-for-op</span></a></p></li>
<li><p><a class="reference internal" href="#aws-security-group-filters-stale"><span class="std std-ref">stale</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-tag-count"><span class="std std-ref">tag-count</span></a></p></li>
<li><p><a class="reference internal" href="#aws-security-group-filters-unused"><span class="std std-ref">unused</span></a></p></li>
<li><p><a class="reference internal" href="#aws-security-group-filters-used"><span class="std std-ref">used</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-value"><span class="std std-ref">value</span></a></p></li>
</ul>
</div></blockquote>
<div class="section" id="aws-security-group-filters-default-vpc">
<span id="id58"></span><h4>default-vpc<a class="headerlink" href="#aws-security-group-filters-default-vpc" title="Permalink to this headline">¶</a></h4>
<p>Filter that returns any security group that exists within the default vpc</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">security-group-default-vpc</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">security-group</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">default-vpc</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">default-vpc</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="diff">
<span id="aws-security-group-filters-diff"></span><h4>diff<a class="headerlink" href="#diff" title="Permalink to this headline">¶</a></h4>
<p>Compute the diff from the current resource to a previous version.</p>
<p>A resource matches the filter if a diff exists between the current
resource and the selected revision.</p>
<p>Utilizes config as a resource revision database.</p>
<p>Revisions can be selected by date, against the previous version, and
against a locked version (requires use of is-locked filter).</p>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">selector</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">previous</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">date</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">locked</span>
  <span class="nt">selector_value</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">diff</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="egress">
<span id="aws-security-group-filters-egress"></span><h4>egress<a class="headerlink" href="#egress" title="Permalink to this headline">¶</a></h4>
<p>Filter for verifying security group ingress and egress permissions</p>
<p>All attributes of a security group permission are available as
value filters.</p>
<p>If multiple attributes are specified the permission must satisfy
all of them. Note that within an attribute match against a list value
of a permission we default to or.</p>
<p>If a group has any permissions that match all conditions, then it
matches the filter.</p>
<p>Permissions that match on the group are annotated onto the group and
can subsequently be used by the remove-permission action.</p>
<p>We have specialized handling for matching <cite>Ports</cite> in ingress/egress
permission From/To range. The following example matches on ingress
rules which allow for a range that includes all of the given ports.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ingress</span>
  <span class="nt">Ports</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">22</span><span class="p p-Indicator">,</span> <span class="nv">443</span><span class="p p-Indicator">,</span> <span class="nv">80</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
<p>As well for verifying that a rule only allows for a specific set of ports
as in the following example. The delta between this and the previous
example is that if the permission allows for any ports not specified here,
then the rule will match. ie. OnlyPorts is a negative assertion match,
it matches when a permission includes ports outside of the specified set.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ingress</span>
  <span class="nt">OnlyPorts</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">22</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
<p>For simplifying ipranges handling which is specified as a list on a rule
we provide a <cite>Cidr</cite> key which can be used as a value type filter evaluated
against each of the rules. If any iprange cidr match then the permission
matches.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ingress</span>
  <span class="nt">IpProtocol</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">-1</span>
  <span class="nt">FromPort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">445</span>
</pre></div>
</div>
<p>We also have specialized handling for matching self-references in
ingress/egress permissions. The following example matches on ingress
rules which allow traffic its own same security group.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ingress</span>
  <span class="nt">SelfReference</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
</pre></div>
</div>
<p>As well for assertions that a ingress/egress permission only matches
a given set of ports, <em>note</em> OnlyPorts is an inverse match.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">egress</span>
  <span class="nt">OnlyPorts</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">22</span><span class="p p-Indicator">,</span> <span class="nv">443</span><span class="p p-Indicator">,</span> <span class="nv">80</span><span class="p p-Indicator">]</span>

<span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">egress</span>
  <span class="nt">Cidr</span><span class="p">:</span>
    <span class="nt">value_type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cidr</span>
    <span class="nt">op</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">in</span>
    <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">x.y.z</span>
</pre></div>
</div>
<p><cite>Cidr</cite> can match ipv4 rules and <cite>CidrV6</cite> can match ipv6 rules.  In
this example we are blocking global inbound connections to SSH or
RDP.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ingress</span>
  <span class="nt">Ports</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">22</span><span class="p p-Indicator">,</span> <span class="nv">3389</span><span class="p p-Indicator">]</span>
  <span class="nt">Cidr</span><span class="p">:</span>
    <span class="nt">value</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;0.0.0.0/0&quot;</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;::/0&quot;</span>
    <span class="nt">op</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">in</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">Cidr</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
  <span class="nt">CidrV6</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
  <span class="nt">Description</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
  <span class="nt">FromPort</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
  <span class="nt">IpProtocol</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">-1</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">tcp</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">udp</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">icmp</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">icmpv6</span>
  <span class="nt">IpRanges</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
  <span class="nt">OnlyPorts</span><span class="p">:</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
  <span class="nt">PrefixListIds</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
  <span class="nt">SelfReference</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">ToPort</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
  <span class="nt">UserIdGroupPairs</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
  <span class="nt">match-operator</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">or</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">and</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">egress</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="ingress">
<span id="aws-security-group-filters-ingress"></span><h4>ingress<a class="headerlink" href="#ingress" title="Permalink to this headline">¶</a></h4>
<p>Filter for verifying security group ingress and egress permissions</p>
<p>All attributes of a security group permission are available as
value filters.</p>
<p>If multiple attributes are specified the permission must satisfy
all of them. Note that within an attribute match against a list value
of a permission we default to or.</p>
<p>If a group has any permissions that match all conditions, then it
matches the filter.</p>
<p>Permissions that match on the group are annotated onto the group and
can subsequently be used by the remove-permission action.</p>
<p>We have specialized handling for matching <cite>Ports</cite> in ingress/egress
permission From/To range. The following example matches on ingress
rules which allow for a range that includes all of the given ports.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ingress</span>
  <span class="nt">Ports</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">22</span><span class="p p-Indicator">,</span> <span class="nv">443</span><span class="p p-Indicator">,</span> <span class="nv">80</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
<p>As well for verifying that a rule only allows for a specific set of ports
as in the following example. The delta between this and the previous
example is that if the permission allows for any ports not specified here,
then the rule will match. ie. OnlyPorts is a negative assertion match,
it matches when a permission includes ports outside of the specified set.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ingress</span>
  <span class="nt">OnlyPorts</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">22</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
<p>For simplifying ipranges handling which is specified as a list on a rule
we provide a <cite>Cidr</cite> key which can be used as a value type filter evaluated
against each of the rules. If any iprange cidr match then the permission
matches.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ingress</span>
  <span class="nt">IpProtocol</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">-1</span>
  <span class="nt">FromPort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">445</span>
</pre></div>
</div>
<p>We also have specialized handling for matching self-references in
ingress/egress permissions. The following example matches on ingress
rules which allow traffic its own same security group.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ingress</span>
  <span class="nt">SelfReference</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
</pre></div>
</div>
<p>As well for assertions that a ingress/egress permission only matches
a given set of ports, <em>note</em> OnlyPorts is an inverse match.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">egress</span>
  <span class="nt">OnlyPorts</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">22</span><span class="p p-Indicator">,</span> <span class="nv">443</span><span class="p p-Indicator">,</span> <span class="nv">80</span><span class="p p-Indicator">]</span>

<span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">egress</span>
  <span class="nt">Cidr</span><span class="p">:</span>
    <span class="nt">value_type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cidr</span>
    <span class="nt">op</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">in</span>
    <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">x.y.z</span>
</pre></div>
</div>
<p><cite>Cidr</cite> can match ipv4 rules and <cite>CidrV6</cite> can match ipv6 rules.  In
this example we are blocking global inbound connections to SSH or
RDP.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ingress</span>
  <span class="nt">Ports</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">22</span><span class="p p-Indicator">,</span> <span class="nv">3389</span><span class="p p-Indicator">]</span>
  <span class="nt">Cidr</span><span class="p">:</span>
    <span class="nt">value</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;0.0.0.0/0&quot;</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;::/0&quot;</span>
    <span class="nt">op</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">in</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">Cidr</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
  <span class="nt">CidrV6</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
  <span class="nt">Description</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
  <span class="nt">FromPort</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
  <span class="nt">IpProtocol</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">-1</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">tcp</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">udp</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">icmp</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">icmpv6</span>
  <span class="nt">IpRanges</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
  <span class="nt">OnlyPorts</span><span class="p">:</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
  <span class="nt">Ports</span><span class="p">:</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
  <span class="nt">PrefixListIds</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
  <span class="nt">SelfReference</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">ToPort</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
  <span class="nt">UserIdGroupPairs</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
  <span class="nt">match-operator</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">or</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">and</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ingress</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="aws-security-group-filters-json-diff">
<span id="id59"></span><h4>json-diff<a class="headerlink" href="#aws-security-group-filters-json-diff" title="Permalink to this headline">¶</a></h4>
<p>Compute the diff from the current resource to a previous version.</p>
<p>A resource matches the filter if a diff exists between the current
resource and the selected revision.</p>
<p>Utilizes config as a resource revision database.</p>
<p>Revisions can be selected by date, against the previous version, and
against a locked version (requires use of is-locked filter).</p>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">selector</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">previous</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">date</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">locked</span>
  <span class="nt">selector_value</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">json-diff</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="stale">
<span id="aws-security-group-filters-stale"></span><h4>stale<a class="headerlink" href="#stale" title="Permalink to this headline">¶</a></h4>
<p>Filter to find security groups that contain stale references
to other groups that are either no longer present or traverse
a broken vpc peering connection. Note this applies to VPC
Security groups only and will implicitly filter security groups.</p>
<dl class="simple">
<dt>AWS Docs:</dt><dd><p><a class="reference external" href="https://docs.aws.amazon.com/vpc/latest/peering/vpc-peering-security-groups.html">https://docs.aws.amazon.com/vpc/latest/peering/vpc-peering-security-groups.html</a></p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">stale-security-groups</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">security-group</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">stale</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">stale</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="aws-security-group-filters-unused">
<span id="id60"></span><h4>unused<a class="headerlink" href="#aws-security-group-filters-unused" title="Permalink to this headline">¶</a></h4>
<p>Filter to just vpc security groups that are not used.</p>
<p>We scan all extant enis in the vpc to get a baseline set of groups
in use. Then augment with those referenced by launch configs, and
lambdas as they may not have extant resources in the vpc at a
given moment. We also find any security group with references from
other security group either within the vpc or across peered
connections.</p>
<p>Note this filter does not support classic security groups atm.</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">security-groups-unused</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">security-group</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">unused</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">unused</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="used">
<span id="aws-security-group-filters-used"></span><h4>used<a class="headerlink" href="#used" title="Permalink to this headline">¶</a></h4>
<p>Filter to security groups that are used.</p>
<p>This operates as a complement to the unused filter for multi-step
workflows.</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">security-groups-in-use</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">security-group</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">used</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">used</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id61">
<h3>Actions<a class="headerlink" href="#id61" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-auto-tag-user"><span class="std std-ref">auto-tag-user</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-copy-related-tag"><span class="std std-ref">copy-related-tag</span></a></p></li>
<li><p><a class="reference internal" href="#aws-security-group-actions-delete"><span class="std std-ref">delete</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-lambda"><span class="std std-ref">invoke-lambda</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-sfn"><span class="std std-ref">invoke-sfn</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-mark-for-op"><span class="std std-ref">mark-for-op</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-normalize-tag"><span class="std std-ref">normalize-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-notify"><span class="std std-ref">notify</span></a></p></li>
<li><p><a class="reference internal" href="#aws-security-group-actions-patch"><span class="std std-ref">patch</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-post-finding"><span class="std std-ref">post-finding</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-put-metric"><span class="std std-ref">put-metric</span></a></p></li>
<li><p><a class="reference internal" href="#aws-security-group-actions-remove-permissions"><span class="std std-ref">remove-permissions</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-remove-tag"><span class="std std-ref">remove-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-rename-tag"><span class="std std-ref">rename-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag"><span class="std std-ref">tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag-trim"><span class="std std-ref">tag-trim</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-webhook"><span class="std std-ref">webhook</span></a></p></li>
</ul>
</div></blockquote>
<div class="section" id="aws-security-group-actions-delete">
<span id="id62"></span><h4>delete<a class="headerlink" href="#aws-security-group-actions-delete" title="Permalink to this headline">¶</a></h4>
<p>Action to delete security group(s)</p>
<p>It is recommended to apply a filter to the delete policy to avoid the
deletion of all security groups returned.</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">security-groups-unused-delete</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">security-group</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">unused</span>
    <span class="nt">actions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">delete</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">delete</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="patch">
<span id="aws-security-group-actions-patch"></span><h4>patch<a class="headerlink" href="#patch" title="Permalink to this headline">¶</a></h4>
<p>Modify a resource via application of a reverse delta.</p>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">patch</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="remove-permissions">
<span id="aws-security-group-actions-remove-permissions"></span><h4>remove-permissions<a class="headerlink" href="#remove-permissions" title="Permalink to this headline">¶</a></h4>
<p>Action to remove ingress/egress rule(s) from a security group</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">security-group-revoke-8080</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">security-group</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ingress</span>
        <span class="nt">IpProtocol</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">tcp</span>
        <span class="nt">Ports</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">8080</span><span class="p p-Indicator">]</span>
    <span class="nt">actions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">remove-permissions</span>
        <span class="nt">ingress</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">matched</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">egress</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">matched</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">all</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">ingress</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">matched</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">all</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">remove-permissions</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="aws-subnet">
<span id="id63"></span><h2>aws.subnet<a class="headerlink" href="#aws-subnet" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id64">
<h3>Filters<a class="headerlink" href="#id64" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-config-compliance"><span class="std std-ref">config-compliance</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-event"><span class="std std-ref">event</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-finding"><span class="std std-ref">finding</span></a></p></li>
<li><p><a class="reference internal" href="#aws-subnet-filters-flow-logs"><span class="std std-ref">flow-logs</span></a></p></li>
<li><p><a class="reference internal" href="#aws-subnet-filters-json-diff"><span class="std std-ref">json-diff</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-marked-for-op"><span class="std std-ref">marked-for-op</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-tag-count"><span class="std std-ref">tag-count</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-value"><span class="std std-ref">value</span></a></p></li>
</ul>
</div></blockquote>
<div class="section" id="aws-subnet-filters-flow-logs">
<span id="id65"></span><h4>flow-logs<a class="headerlink" href="#aws-subnet-filters-flow-logs" title="Permalink to this headline">¶</a></h4>
<p>Are flow logs enabled on the resource.</p>
<p>ie to find all vpcs with flows logs disabled we can do this</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">flow-logs-enabled</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vpc</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">flow-logs</span>
</pre></div>
</div>
<p>or to find all vpcs with flow logs but that don’t match a
particular configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">flow-mis-configured</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vpc</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">not</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">flow-logs</span>
          <span class="nt">enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
          <span class="nt">set-op</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">or</span>
          <span class="nt">op</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">equal</span>
          <span class="c1"># equality operator applies to following keys</span>
          <span class="nt">traffic-type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">all</span>
          <span class="nt">status</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">active</span>
          <span class="nt">log-group</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vpc-logs</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">deliver-status</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">success</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">failure</span>
  <span class="nt">destination</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">destination-type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">s3</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cloud-watch-logs</span>
  <span class="nt">enabled</span><span class="p">:</span>
    <span class="nt">default</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">log-group</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">op</span><span class="p">:</span>
    <span class="nt">default</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">equal</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">equal</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not-equal</span>
  <span class="nt">set-op</span><span class="p">:</span>
    <span class="nt">default</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">or</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">or</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">and</span>
  <span class="nt">status</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">active</span>
  <span class="nt">traffic-type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">accept</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">reject</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">all</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">flow-logs</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="aws-subnet-filters-json-diff">
<span id="id66"></span><h4>json-diff<a class="headerlink" href="#aws-subnet-filters-json-diff" title="Permalink to this headline">¶</a></h4>
<p>Compute the diff from the current resource to a previous version.</p>
<p>A resource matches the filter if a diff exists between the current
resource and the selected revision.</p>
<p>Utilizes config as a resource revision database.</p>
<p>Revisions can be selected by date, against the previous version, and
against a locked version (requires use of is-locked filter).</p>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">selector</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">previous</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">date</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">locked</span>
  <span class="nt">selector_value</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">json-diff</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id67">
<h3>Actions<a class="headerlink" href="#id67" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-auto-tag-user"><span class="std std-ref">auto-tag-user</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-copy-related-tag"><span class="std std-ref">copy-related-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-lambda"><span class="std std-ref">invoke-lambda</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-sfn"><span class="std std-ref">invoke-sfn</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-mark-for-op"><span class="std std-ref">mark-for-op</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-normalize-tag"><span class="std std-ref">normalize-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-notify"><span class="std std-ref">notify</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-post-finding"><span class="std std-ref">post-finding</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-put-metric"><span class="std std-ref">put-metric</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-remove-tag"><span class="std std-ref">remove-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-rename-tag"><span class="std std-ref">rename-tag</span></a></p></li>
<li><p><a class="reference internal" href="#aws-subnet-actions-set-flow-log"><span class="std std-ref">set-flow-log</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag"><span class="std std-ref">tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag-trim"><span class="std std-ref">tag-trim</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-webhook"><span class="std std-ref">webhook</span></a></p></li>
</ul>
</div></blockquote>
<div class="section" id="aws-subnet-actions-set-flow-log">
<span id="id68"></span><h4>set-flow-log<a class="headerlink" href="#aws-subnet-actions-set-flow-log" title="Permalink to this headline">¶</a></h4>
<p>Create flow logs for a network resource</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vpc-enable-flow-logs</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vpc</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">flow-logs</span>
        <span class="nt">enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="nt">actions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">set-flow-log</span>
        <span class="nt">DeliverLogsPermissionArn</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">arn:iam:role</span>
        <span class="nt">LogGroupName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/custodian/vpc/flowlogs/</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">DeliverLogsPermissionArn</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">LogDestination</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">LogDestinationType</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">s3</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cloud-watch-logs</span>
  <span class="nt">LogGroupName</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">TrafficType</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ACCEPT</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">REJECT</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ALL</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">state</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">set-flow-log</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="aws-transit-attachment">
<span id="id69"></span><h2>aws.transit-attachment<a class="headerlink" href="#aws-transit-attachment" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id70">
<h3>Filters<a class="headerlink" href="#id70" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-event"><span class="std std-ref">event</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-finding"><span class="std std-ref">finding</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-marked-for-op"><span class="std std-ref">marked-for-op</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-tag-count"><span class="std std-ref">tag-count</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-value"><span class="std std-ref">value</span></a></p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="id71">
<h3>Actions<a class="headerlink" href="#id71" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-auto-tag-user"><span class="std std-ref">auto-tag-user</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-copy-related-tag"><span class="std std-ref">copy-related-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-lambda"><span class="std std-ref">invoke-lambda</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-sfn"><span class="std std-ref">invoke-sfn</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-mark-for-op"><span class="std std-ref">mark-for-op</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-normalize-tag"><span class="std std-ref">normalize-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-notify"><span class="std std-ref">notify</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-put-metric"><span class="std std-ref">put-metric</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-remove-tag"><span class="std std-ref">remove-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-rename-tag"><span class="std std-ref">rename-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag"><span class="std std-ref">tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag-trim"><span class="std std-ref">tag-trim</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-webhook"><span class="std std-ref">webhook</span></a></p></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="aws-transit-gateway">
<span id="id72"></span><h2>aws.transit-gateway<a class="headerlink" href="#aws-transit-gateway" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id73">
<h3>Filters<a class="headerlink" href="#id73" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-event"><span class="std std-ref">event</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-finding"><span class="std std-ref">finding</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-marked-for-op"><span class="std std-ref">marked-for-op</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-tag-count"><span class="std std-ref">tag-count</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-value"><span class="std std-ref">value</span></a></p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="id74">
<h3>Actions<a class="headerlink" href="#id74" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-auto-tag-user"><span class="std std-ref">auto-tag-user</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-copy-related-tag"><span class="std std-ref">copy-related-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-lambda"><span class="std std-ref">invoke-lambda</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-sfn"><span class="std std-ref">invoke-sfn</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-mark-for-op"><span class="std std-ref">mark-for-op</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-normalize-tag"><span class="std std-ref">normalize-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-notify"><span class="std std-ref">notify</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-post-finding"><span class="std std-ref">post-finding</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-put-metric"><span class="std std-ref">put-metric</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-remove-tag"><span class="std std-ref">remove-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-rename-tag"><span class="std std-ref">rename-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag"><span class="std std-ref">tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag-trim"><span class="std std-ref">tag-trim</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-webhook"><span class="std std-ref">webhook</span></a></p></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="aws-vpc">
<span id="id75"></span><h2>aws.vpc<a class="headerlink" href="#aws-vpc" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id76">
<h3>Filters<a class="headerlink" href="#id76" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-config-compliance"><span class="std std-ref">config-compliance</span></a></p></li>
<li><p><a class="reference internal" href="#aws-vpc-filters-dhcp-options"><span class="std std-ref">dhcp-options</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-event"><span class="std std-ref">event</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-finding"><span class="std std-ref">finding</span></a></p></li>
<li><p><a class="reference internal" href="#aws-vpc-filters-flow-logs"><span class="std std-ref">flow-logs</span></a></p></li>
<li><p><a class="reference internal" href="#aws-vpc-filters-internet-gateway"><span class="std std-ref">internet-gateway</span></a></p></li>
<li><p><a class="reference internal" href="#aws-vpc-filters-json-diff"><span class="std std-ref">json-diff</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-marked-for-op"><span class="std std-ref">marked-for-op</span></a></p></li>
<li><p><a class="reference internal" href="#aws-vpc-filters-nat-gateway"><span class="std std-ref">nat-gateway</span></a></p></li>
<li><p><a class="reference internal" href="#aws-vpc-filters-security-group"><span class="std std-ref">security-group</span></a></p></li>
<li><p><a class="reference internal" href="#aws-vpc-filters-subnet"><span class="std std-ref">subnet</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-tag-count"><span class="std std-ref">tag-count</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-value"><span class="std std-ref">value</span></a></p></li>
<li><p><a class="reference internal" href="#aws-vpc-filters-vpc-attributes"><span class="std std-ref">vpc-attributes</span></a></p></li>
</ul>
</div></blockquote>
<div class="section" id="dhcp-options">
<span id="aws-vpc-filters-dhcp-options"></span><h4>dhcp-options<a class="headerlink" href="#dhcp-options" title="Permalink to this headline">¶</a></h4>
<p>Filter VPCs based on their dhcp options</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
   <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vpcs-in-domain</span>
     <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vpc</span>
     <span class="nt">filters</span><span class="p">:</span>
       <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">dhcp-options</span>
         <span class="nt">domain-name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2.internal</span>
</pre></div>
</div>
</div></blockquote>
<p>if an option value is specified as a list, then all elements must be present.
if an option value is specified as a string, then that string must be present.</p>
<p>vpcs not matching a given option value can be found via specifying
a <cite>present: false</cite> parameter.</p>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">domain-name</span><span class="p">:</span>
    <span class="nt">oneOf</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">items</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">domain-name-servers</span><span class="p">:</span>
    <span class="nt">oneOf</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">items</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">ntp-servers</span><span class="p">:</span>
    <span class="nt">oneOf</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">items</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">present</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">dhcp-options</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="aws-vpc-filters-flow-logs">
<span id="id77"></span><h4>flow-logs<a class="headerlink" href="#aws-vpc-filters-flow-logs" title="Permalink to this headline">¶</a></h4>
<p>Are flow logs enabled on the resource.</p>
<p>ie to find all vpcs with flows logs disabled we can do this</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">flow-logs-enabled</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vpc</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">flow-logs</span>
</pre></div>
</div>
<p>or to find all vpcs with flow logs but that don’t match a
particular configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">flow-mis-configured</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vpc</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">not</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">flow-logs</span>
          <span class="nt">enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
          <span class="nt">set-op</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">or</span>
          <span class="nt">op</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">equal</span>
          <span class="c1"># equality operator applies to following keys</span>
          <span class="nt">traffic-type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">all</span>
          <span class="nt">status</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">active</span>
          <span class="nt">log-group</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vpc-logs</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">deliver-status</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">success</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">failure</span>
  <span class="nt">destination</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">destination-type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">s3</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cloud-watch-logs</span>
  <span class="nt">enabled</span><span class="p">:</span>
    <span class="nt">default</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">log-group</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">op</span><span class="p">:</span>
    <span class="nt">default</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">equal</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">equal</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not-equal</span>
  <span class="nt">set-op</span><span class="p">:</span>
    <span class="nt">default</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">or</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">or</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">and</span>
  <span class="nt">status</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">active</span>
  <span class="nt">traffic-type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">accept</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">reject</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">all</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">flow-logs</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="internet-gateway">
<span id="aws-vpc-filters-internet-gateway"></span><h4>internet-gateway<a class="headerlink" href="#internet-gateway" title="Permalink to this headline">¶</a></h4>
<p>Filter VPCs based on Internet Gateway attributes</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vpc-by-igw</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vpc</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">internet-gateway</span>
        <span class="nt">key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">tag:Color</span>
        <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Gray</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">default</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
  <span class="nt">key</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">match-resource</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">op</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">eq</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">equal</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ne</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not-equal</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">gt</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">greater-than</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ge</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">gte</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">le</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lte</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lt</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">less-than</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">glob</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">regex</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">regex-case</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">in</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ni</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not-in</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">contains</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">difference</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">intersect</span>
  <span class="nt">operator</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">and</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">or</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">internet-gateway</span>
  <span class="nt">value</span><span class="p">:</span>
    <span class="nt">oneOf</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="s">&#39;null&#39;</span>
  <span class="nt">value_from</span><span class="p">:</span>
    <span class="nt">additionalProperties</span><span class="p">:</span> <span class="s">&#39;False&#39;</span>
    <span class="nt">properties</span><span class="p">:</span>
      <span class="nt">expr</span><span class="p">:</span>
        <span class="nt">oneOf</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
        <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
      <span class="nt">format</span><span class="p">:</span>
        <span class="nt">enum</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">csv</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">json</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">txt</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">csv2dict</span>
      <span class="nt">url</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">required</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">url</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
  <span class="nt">value_regex</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">value_type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">age</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">expiration</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">normalize</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">size</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cidr</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cidr_size</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">swap</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">resource_count</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">expr</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">unique_size</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">date</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="aws-vpc-filters-json-diff">
<span id="id78"></span><h4>json-diff<a class="headerlink" href="#aws-vpc-filters-json-diff" title="Permalink to this headline">¶</a></h4>
<p>Compute the diff from the current resource to a previous version.</p>
<p>A resource matches the filter if a diff exists between the current
resource and the selected revision.</p>
<p>Utilizes config as a resource revision database.</p>
<p>Revisions can be selected by date, against the previous version, and
against a locked version (requires use of is-locked filter).</p>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">selector</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">previous</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">date</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">locked</span>
  <span class="nt">selector_value</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">json-diff</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="nat-gateway">
<span id="aws-vpc-filters-nat-gateway"></span><h4>nat-gateway<a class="headerlink" href="#nat-gateway" title="Permalink to this headline">¶</a></h4>
<p>Filter VPCs based on NAT Gateway attributes</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vpc-by-nat</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vpc</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nat-gateway</span>
        <span class="nt">key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">tag:Color</span>
        <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Gray</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">default</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
  <span class="nt">key</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">match-resource</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">op</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">eq</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">equal</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ne</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not-equal</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">gt</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">greater-than</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ge</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">gte</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">le</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lte</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lt</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">less-than</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">glob</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">regex</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">regex-case</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">in</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ni</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not-in</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">contains</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">difference</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">intersect</span>
  <span class="nt">operator</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">and</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">or</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">nat-gateway</span>
  <span class="nt">value</span><span class="p">:</span>
    <span class="nt">oneOf</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="s">&#39;null&#39;</span>
  <span class="nt">value_from</span><span class="p">:</span>
    <span class="nt">additionalProperties</span><span class="p">:</span> <span class="s">&#39;False&#39;</span>
    <span class="nt">properties</span><span class="p">:</span>
      <span class="nt">expr</span><span class="p">:</span>
        <span class="nt">oneOf</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
        <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
      <span class="nt">format</span><span class="p">:</span>
        <span class="nt">enum</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">csv</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">json</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">txt</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">csv2dict</span>
      <span class="nt">url</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">required</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">url</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
  <span class="nt">value_regex</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">value_type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">age</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">expiration</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">normalize</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">size</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cidr</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cidr_size</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">swap</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">resource_count</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">expr</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">unique_size</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">date</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="security-group">
<span id="aws-vpc-filters-security-group"></span><h4>security-group<a class="headerlink" href="#security-group" title="Permalink to this headline">¶</a></h4>
<p>Filter VPCs based on Security Group attributes</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vpc-by-sg</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vpc</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">security-group</span>
        <span class="nt">key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">tag:Color</span>
        <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Gray</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">default</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
  <span class="nt">key</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">match-resource</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">op</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">eq</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">equal</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ne</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not-equal</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">gt</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">greater-than</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ge</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">gte</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">le</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lte</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lt</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">less-than</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">glob</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">regex</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">regex-case</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">in</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ni</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not-in</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">contains</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">difference</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">intersect</span>
  <span class="nt">operator</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">and</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">or</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">security-group</span>
  <span class="nt">value</span><span class="p">:</span>
    <span class="nt">oneOf</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="s">&#39;null&#39;</span>
  <span class="nt">value_from</span><span class="p">:</span>
    <span class="nt">additionalProperties</span><span class="p">:</span> <span class="s">&#39;False&#39;</span>
    <span class="nt">properties</span><span class="p">:</span>
      <span class="nt">expr</span><span class="p">:</span>
        <span class="nt">oneOf</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
        <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
      <span class="nt">format</span><span class="p">:</span>
        <span class="nt">enum</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">csv</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">json</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">txt</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">csv2dict</span>
      <span class="nt">url</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">required</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">url</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
  <span class="nt">value_regex</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">value_type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">age</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">expiration</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">normalize</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">size</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cidr</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cidr_size</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">swap</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">resource_count</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">expr</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">unique_size</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">date</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="subnet">
<span id="aws-vpc-filters-subnet"></span><h4>subnet<a class="headerlink" href="#subnet" title="Permalink to this headline">¶</a></h4>
<p>Filter VPCs based on Subnet attributes</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vpc-by-subnet</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vpc</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">subnet</span>
        <span class="nt">key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">tag:Color</span>
        <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Gray</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">default</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
  <span class="nt">key</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">match-resource</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">op</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">eq</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">equal</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ne</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not-equal</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">gt</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">greater-than</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ge</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">gte</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">le</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lte</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lt</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">less-than</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">glob</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">regex</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">regex-case</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">in</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ni</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not-in</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">contains</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">difference</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">intersect</span>
  <span class="nt">operator</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">and</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">or</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">subnet</span>
  <span class="nt">value</span><span class="p">:</span>
    <span class="nt">oneOf</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="s">&#39;null&#39;</span>
  <span class="nt">value_from</span><span class="p">:</span>
    <span class="nt">additionalProperties</span><span class="p">:</span> <span class="s">&#39;False&#39;</span>
    <span class="nt">properties</span><span class="p">:</span>
      <span class="nt">expr</span><span class="p">:</span>
        <span class="nt">oneOf</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
        <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
      <span class="nt">format</span><span class="p">:</span>
        <span class="nt">enum</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">csv</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">json</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">txt</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">csv2dict</span>
      <span class="nt">url</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">required</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">url</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
  <span class="nt">value_regex</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">value_type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">age</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">expiration</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">normalize</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">size</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cidr</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cidr_size</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">swap</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">resource_count</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">expr</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">unique_size</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">date</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="vpc-attributes">
<span id="aws-vpc-filters-vpc-attributes"></span><h4>vpc-attributes<a class="headerlink" href="#vpc-attributes" title="Permalink to this headline">¶</a></h4>
<p>Filters VPCs based on their DNS attributes</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">dns-hostname-enabled</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vpc</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vpc-attributes</span>
        <span class="nt">dnshostnames</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">dnshostnames</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">dnssupport</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">vpc-attributes</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id79">
<h3>Actions<a class="headerlink" href="#id79" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-auto-tag-user"><span class="std std-ref">auto-tag-user</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-copy-related-tag"><span class="std std-ref">copy-related-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-lambda"><span class="std std-ref">invoke-lambda</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-sfn"><span class="std std-ref">invoke-sfn</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-mark-for-op"><span class="std std-ref">mark-for-op</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-normalize-tag"><span class="std std-ref">normalize-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-notify"><span class="std std-ref">notify</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-post-finding"><span class="std std-ref">post-finding</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-put-metric"><span class="std std-ref">put-metric</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-remove-tag"><span class="std std-ref">remove-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-rename-tag"><span class="std std-ref">rename-tag</span></a></p></li>
<li><p><a class="reference internal" href="#aws-vpc-actions-set-flow-log"><span class="std std-ref">set-flow-log</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag"><span class="std std-ref">tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag-trim"><span class="std std-ref">tag-trim</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-webhook"><span class="std std-ref">webhook</span></a></p></li>
</ul>
</div></blockquote>
<div class="section" id="aws-vpc-actions-set-flow-log">
<span id="id80"></span><h4>set-flow-log<a class="headerlink" href="#aws-vpc-actions-set-flow-log" title="Permalink to this headline">¶</a></h4>
<p>Create flow logs for a network resource</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vpc-enable-flow-logs</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vpc</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">flow-logs</span>
        <span class="nt">enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="nt">actions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">set-flow-log</span>
        <span class="nt">DeliverLogsPermissionArn</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">arn:iam:role</span>
        <span class="nt">LogGroupName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/custodian/vpc/flowlogs/</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">DeliverLogsPermissionArn</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">LogDestination</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">LogDestinationType</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">s3</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cloud-watch-logs</span>
  <span class="nt">LogGroupName</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">TrafficType</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ACCEPT</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">REJECT</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ALL</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">state</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">set-flow-log</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="aws-vpc-endpoint">
<span id="id81"></span><h2>aws.vpc-endpoint<a class="headerlink" href="#aws-vpc-endpoint" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id82">
<h3>Filters<a class="headerlink" href="#id82" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="#aws-vpc-endpoint-filters-cross-account"><span class="std std-ref">cross-account</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-event"><span class="std std-ref">event</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-finding"><span class="std std-ref">finding</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-security-group"><span class="std std-ref">security-group</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-subnet"><span class="std std-ref">subnet</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-value"><span class="std std-ref">value</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-vpc"><span class="std std-ref">vpc</span></a></p></li>
</ul>
</div></blockquote>
<div class="section" id="aws-vpc-endpoint-filters-cross-account">
<span id="id83"></span><h4>cross-account<a class="headerlink" href="#aws-vpc-endpoint-filters-cross-account" title="Permalink to this headline">¶</a></h4>
<p>Check a resource’s embedded iam policy for cross account access.</p>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">actions</span><span class="p">:</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
  <span class="nt">everyone_only</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cross-account</span>
  <span class="nt">whitelist</span><span class="p">:</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
  <span class="nt">whitelist_conditions</span><span class="p">:</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
  <span class="nt">whitelist_from</span><span class="p">:</span> <span class="nl">&amp;id001</span>
    <span class="nt">additionalProperties</span><span class="p">:</span> <span class="s">&#39;False&#39;</span>
    <span class="nt">properties</span><span class="p">:</span>
      <span class="nt">expr</span><span class="p">:</span>
        <span class="nt">oneOf</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
        <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
      <span class="nt">format</span><span class="p">:</span>
        <span class="nt">enum</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">csv</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">json</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">txt</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">csv2dict</span>
      <span class="nt">url</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">required</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">url</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
  <span class="nt">whitelist_orgids</span><span class="p">:</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
  <span class="nt">whitelist_orgids_from</span><span class="p">:</span> <span class="nv">*id001</span>
  <span class="nt">whitelist_vpc</span><span class="p">:</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
  <span class="nt">whitelist_vpc_from</span><span class="p">:</span> <span class="nv">*id001</span>
  <span class="nt">whitelist_vpce</span><span class="p">:</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
  <span class="nt">whitelist_vpce_from</span><span class="p">:</span> <span class="nv">*id001</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id84">
<h3>Actions<a class="headerlink" href="#id84" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-lambda"><span class="std std-ref">invoke-lambda</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-sfn"><span class="std std-ref">invoke-sfn</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-notify"><span class="std std-ref">notify</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-post-finding"><span class="std std-ref">post-finding</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-put-metric"><span class="std std-ref">put-metric</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-webhook"><span class="std std-ref">webhook</span></a></p></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="aws-vpn-connection">
<span id="id85"></span><h2>aws.vpn-connection<a class="headerlink" href="#aws-vpn-connection" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id86">
<h3>Filters<a class="headerlink" href="#id86" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-config-compliance"><span class="std std-ref">config-compliance</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-event"><span class="std std-ref">event</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-finding"><span class="std std-ref">finding</span></a></p></li>
<li><p><a class="reference internal" href="#aws-vpn-connection-filters-json-diff"><span class="std std-ref">json-diff</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-marked-for-op"><span class="std std-ref">marked-for-op</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-tag-count"><span class="std std-ref">tag-count</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-value"><span class="std std-ref">value</span></a></p></li>
</ul>
</div></blockquote>
<div class="section" id="aws-vpn-connection-filters-json-diff">
<span id="id87"></span><h4>json-diff<a class="headerlink" href="#aws-vpn-connection-filters-json-diff" title="Permalink to this headline">¶</a></h4>
<p>Compute the diff from the current resource to a previous version.</p>
<p>A resource matches the filter if a diff exists between the current
resource and the selected revision.</p>
<p>Utilizes config as a resource revision database.</p>
<p>Revisions can be selected by date, against the previous version, and
against a locked version (requires use of is-locked filter).</p>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">selector</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">previous</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">date</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">locked</span>
  <span class="nt">selector_value</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">json-diff</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id88">
<h3>Actions<a class="headerlink" href="#id88" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-auto-tag-user"><span class="std std-ref">auto-tag-user</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-copy-related-tag"><span class="std std-ref">copy-related-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-lambda"><span class="std std-ref">invoke-lambda</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-sfn"><span class="std std-ref">invoke-sfn</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-mark-for-op"><span class="std std-ref">mark-for-op</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-normalize-tag"><span class="std std-ref">normalize-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-notify"><span class="std std-ref">notify</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-post-finding"><span class="std std-ref">post-finding</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-put-metric"><span class="std std-ref">put-metric</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-remove-tag"><span class="std std-ref">remove-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-rename-tag"><span class="std std-ref">rename-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag"><span class="std std-ref">tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag-trim"><span class="std std-ref">tag-trim</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-webhook"><span class="std std-ref">webhook</span></a></p></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="aws-vpn-gateway">
<span id="id89"></span><h2>aws.vpn-gateway<a class="headerlink" href="#aws-vpn-gateway" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id90">
<h3>Filters<a class="headerlink" href="#id90" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-config-compliance"><span class="std std-ref">config-compliance</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-event"><span class="std std-ref">event</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-finding"><span class="std std-ref">finding</span></a></p></li>
<li><p><a class="reference internal" href="#aws-vpn-gateway-filters-json-diff"><span class="std std-ref">json-diff</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-marked-for-op"><span class="std std-ref">marked-for-op</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-tag-count"><span class="std std-ref">tag-count</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-filters.html#aws-common-filters-value"><span class="std std-ref">value</span></a></p></li>
</ul>
</div></blockquote>
<div class="section" id="aws-vpn-gateway-filters-json-diff">
<span id="id91"></span><h4>json-diff<a class="headerlink" href="#aws-vpn-gateway-filters-json-diff" title="Permalink to this headline">¶</a></h4>
<p>Compute the diff from the current resource to a previous version.</p>
<p>A resource matches the filter if a diff exists between the current
resource and the selected revision.</p>
<p>Utilizes config as a resource revision database.</p>
<p>Revisions can be selected by date, against the previous version, and
against a locked version (requires use of is-locked filter).</p>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">selector</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">previous</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">date</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">locked</span>
  <span class="nt">selector_value</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">json-diff</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id92">
<h3>Actions<a class="headerlink" href="#id92" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-auto-tag-user"><span class="std std-ref">auto-tag-user</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-copy-related-tag"><span class="std std-ref">copy-related-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-lambda"><span class="std std-ref">invoke-lambda</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-invoke-sfn"><span class="std std-ref">invoke-sfn</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-mark-for-op"><span class="std std-ref">mark-for-op</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-normalize-tag"><span class="std std-ref">normalize-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-notify"><span class="std std-ref">notify</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-post-finding"><span class="std std-ref">post-finding</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-put-metric"><span class="std std-ref">put-metric</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-remove-tag"><span class="std std-ref">remove-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-rename-tag"><span class="std std-ref">rename-tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag"><span class="std std-ref">tag</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-tag-trim"><span class="std std-ref">tag-trim</span></a></p></li>
<li><p><a class="reference internal" href="aws-common-actions.html#aws-common-actions-webhook"><span class="std std-ref">webhook</span></a></p></li>
</ul>
</div></blockquote>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ecr.html" class="btn btn-neutral float-right" title="aws.ecr resources" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="dynamodbstreams.html" class="btn btn-neutral float-left" title="aws.dynamodbstreams resources" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Capital One Services, LLC

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>