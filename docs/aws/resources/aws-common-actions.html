

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>AWS Common Actions &mdash; Cloud Custodian  documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/icon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script type="text/javascript" src="../../_static/js/expand.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/expand.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="AWS Common Filters" href="aws-common-filters.html" />
    <link rel="prev" title="AWS Reference" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Cloud Custodian
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../filters.html">Generic Filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../actions.html">Generic Actions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart/advanced.html">Advanced Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart/policyStructure.html">Example tag compliance policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../deployment.html">Deployment</a></li>
</ul>
<p class="caption"><span class="caption-text">AWS</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../gettingstarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Example Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aws-modes.html">AWS Modes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Monitoring your environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lambda.html">Lambda Support</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">AWS Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">AWS Common Actions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#auto-tag-user">auto-tag-user</a></li>
<li class="toctree-l3"><a class="reference internal" href="#copy-related-tag">copy-related-tag</a></li>
<li class="toctree-l3"><a class="reference internal" href="#invoke-lambda">invoke-lambda</a></li>
<li class="toctree-l3"><a class="reference internal" href="#invoke-sfn">invoke-sfn</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mark-for-op">mark-for-op</a></li>
<li class="toctree-l3"><a class="reference internal" href="#modify-policy">modify-policy</a></li>
<li class="toctree-l3"><a class="reference internal" href="#modify-security-groups">modify-security-groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="#normalize-tag">normalize-tag</a></li>
<li class="toctree-l3"><a class="reference internal" href="#notify">notify</a></li>
<li class="toctree-l3"><a class="reference internal" href="#post-finding">post-finding</a></li>
<li class="toctree-l3"><a class="reference internal" href="#put-metric">put-metric</a></li>
<li class="toctree-l3"><a class="reference internal" href="#remove-tag">remove-tag</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rename-tag">rename-tag</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tag">tag</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tag-trim">tag-trim</a></li>
<li class="toctree-l3"><a class="reference internal" href="#webhook">webhook</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="aws-common-filters.html">AWS Common Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="account.html">aws.account resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="acm.html">aws.acm resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="apigateway.html">aws.apigateway resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="autoscaling.html">aws.autoscaling resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="backup.html">aws.backup resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="batch.html">aws.batch resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="clouddirectory.html">aws.clouddirectory resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="cloudformation.html">aws.cloudformation resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="cloudfront.html">aws.cloudfront resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="cloudhsm.html">aws.cloudhsm resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="cloudhsmv2.html">aws.cloudhsmv2 resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="cloudsearch.html">aws.cloudsearch resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="cloudtrail.html">aws.cloudtrail resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="cloudwatch.html">aws.cloudwatch resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="codebuild.html">aws.codebuild resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="codecommit.html">aws.codecommit resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="codepipeline.html">aws.codepipeline resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="cognito-identity.html">aws.cognito-identity resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="cognito-idp.html">aws.cognito-idp resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html">aws.config resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="datapipeline.html">aws.datapipeline resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="dax.html">aws.dax resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="directconnect.html">aws.directconnect resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="dlm.html">aws.dlm resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="dms.html">aws.dms resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="ds.html">aws.ds resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="dynamodb.html">aws.dynamodb resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="dynamodbstreams.html">aws.dynamodbstreams resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="ec2.html">aws.ec2 resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="ecr.html">aws.ecr resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="ecs.html">aws.ecs resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="efs.html">aws.efs resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="eks.html">aws.eks resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="elasticache.html">aws.elasticache resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="elasticbeanstalk.html">aws.elasticbeanstalk resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="elb.html">aws.elb resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="elbv2.html">aws.elbv2 resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="emr.html">aws.emr resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="es.html">aws.es resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="events.html">aws.events resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="firehose.html">aws.firehose resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="fsx.html">aws.fsx resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="gamelift.html">aws.gamelift resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="glacier.html">aws.glacier resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="glue.html">aws.glue resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="health.html">aws.health resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="iam.html">aws.iam resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="iot.html">aws.iot resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="kafka.html">aws.kafka resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="kinesis.html">aws.kinesis resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="kinesisanalytics.html">aws.kinesisanalytics resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="kms.html">aws.kms resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="lambda.html">aws.lambda resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="lightsail.html">aws.lightsail resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="logs.html">aws.logs resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="machinelearning.html">aws.machinelearning resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="mq.html">aws.mq resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="opsworks.html">aws.opsworks resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="opsworkscm.html">aws.opsworkscm resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="rds.html">aws.rds resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="redshift.html">aws.redshift resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="route53.html">aws.route53 resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="route53domains.html">aws.route53domains resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="s3.html">aws.s3 resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="sagemaker.html">aws.sagemaker resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="sdb.html">aws.sdb resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="secretsmanager.html">aws.secretsmanager resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="shield.html">aws.shield resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="snowball.html">aws.snowball resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="sns.html">aws.sns resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="sqs.html">aws.sqs resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="ssm.html">aws.ssm resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="stepfunctions.html">aws.stepfunctions resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="storagegateway.html">aws.storagegateway resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="support.html">aws.support resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="waf.html">aws.waf resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="waf-regional.html">aws.waf-regional resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="workspaces.html">aws.workspaces resources</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Azure</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../azure/gettingstarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../azure/authentication.html">Authentication &amp; Access</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../azure/examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../azure/policy/index.html">Supported Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../azure/azure-modes.html">Azure Modes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../azure/advanced/index.html">Advanced Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../azure/contribute.html">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../azure/resources/index.html">Azure Reference</a></li>
</ul>
<p class="caption"><span class="caption-text">GCP</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../gcp/gettingstarted.html">Getting Started (Beta)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gcp/gcp-modes.html">GCP Modes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gcp/examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gcp/policy/index.html">Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gcp/contribute.html">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gcp/contribute.html#adding-new-gcp-resources">Adding New GCP Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gcp/contribute.html#testing">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gcp/resources/index.html">GCP Reference</a></li>
</ul>
<p class="caption"><span class="caption-text">Tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tools/c7n-org.html">c7n-org: Multi Account Custodian Execution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/c7n-policystream.html">c7n-policystream: Policy Changes from Git</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/c7n-mailer.html">c7n-mailer: Custodian Mailer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/c7n-trailcreator.html">AWS Retroactive Tagging Resource Creators</a></li>
</ul>
<p class="caption"><span class="caption-text">Contributing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contribute.html">Contributing to Cloud Custodian</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developer/index.html">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developer/installing.html">Installing for Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developer/tests.html">Testing for Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developer/documentation.html">Documentation For Developers</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Cloud Custodian</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">AWS Reference</a> &raquo;</li>
        
      <li>AWS Common Actions</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="aws-common-actions">
<h1>AWS Common Actions<a class="headerlink" href="#aws-common-actions" title="Permalink to this headline">¶</a></h1>
<p>Actions</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="#aws-common-actions-auto-tag-user"><span class="std std-ref">auto-tag-user</span></a></p></li>
<li><p><a class="reference internal" href="#aws-common-actions-copy-related-tag"><span class="std std-ref">copy-related-tag</span></a></p></li>
<li><p><a class="reference internal" href="#aws-common-actions-invoke-lambda"><span class="std std-ref">invoke-lambda</span></a></p></li>
<li><p><a class="reference internal" href="#aws-common-actions-invoke-sfn"><span class="std std-ref">invoke-sfn</span></a></p></li>
<li><p><a class="reference internal" href="#aws-common-actions-mark-for-op"><span class="std std-ref">mark-for-op</span></a></p></li>
<li><p><a class="reference internal" href="#aws-common-actions-modify-policy"><span class="std std-ref">modify-policy</span></a></p></li>
<li><p><a class="reference internal" href="#aws-common-actions-modify-security-groups"><span class="std std-ref">modify-security-groups</span></a></p></li>
<li><p><a class="reference internal" href="#aws-common-actions-normalize-tag"><span class="std std-ref">normalize-tag</span></a></p></li>
<li><p><a class="reference internal" href="#aws-common-actions-notify"><span class="std std-ref">notify</span></a></p></li>
<li><p><a class="reference internal" href="#aws-common-actions-post-finding"><span class="std std-ref">post-finding</span></a></p></li>
<li><p><a class="reference internal" href="#aws-common-actions-put-metric"><span class="std std-ref">put-metric</span></a></p></li>
<li><p><a class="reference internal" href="#aws-common-actions-remove-tag"><span class="std std-ref">remove-tag</span></a></p></li>
<li><p><a class="reference internal" href="#aws-common-actions-rename-tag"><span class="std std-ref">rename-tag</span></a></p></li>
<li><p><a class="reference internal" href="#aws-common-actions-tag"><span class="std std-ref">tag</span></a></p></li>
<li><p><a class="reference internal" href="#aws-common-actions-tag-trim"><span class="std std-ref">tag-trim</span></a></p></li>
<li><p><a class="reference internal" href="#aws-common-actions-webhook"><span class="std std-ref">webhook</span></a></p></li>
</ul>
</div></blockquote>
<div class="section" id="auto-tag-user">
<span id="aws-common-actions-auto-tag-user"></span><h2>auto-tag-user<a class="headerlink" href="#auto-tag-user" title="Permalink to this headline">¶</a></h2>
<p>Tag a resource with the user who created/modified it.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2-auto-tag-ownercontact</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
    <span class="nt">description</span><span class="p">:</span> <span class="p p-Indicator">|</span>
      <span class="no">Triggered when a new EC2 Instance is launched. Checks to see if</span>
      <span class="no">it&#39;s missing the OwnerContact tag. If missing it gets created</span>
      <span class="no">with the value of the ID of whomever called the RunInstances API</span>
    <span class="nt">mode</span><span class="p">:</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cloudtrail</span>
      <span class="nt">role</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">arn:aws:iam::123456789000:role/custodian-auto-tagger</span>
      <span class="nt">events</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">RunInstances</span>
    <span class="nt">filters</span><span class="p">:</span>
     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">tag:OwnerContact</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">absent</span>
    <span class="nt">actions</span><span class="p">:</span>
     <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">auto-tag-user</span>
       <span class="nt">tag</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">OwnerContact</span>
</pre></div>
</div>
<p>There’s a number of caveats to usage. Resources which don’t
include tagging as part of their api may have some delay before
automation kicks in to create a tag. Real world delay may be several
minutes, with worst case into hours[0]. This creates a race condition
between auto tagging and automation.</p>
<p>In practice this window is on the order of a fraction of a second, as
we fetch the resource and evaluate the presence of the tag before
attempting to tag it.</p>
<p>References</p>
<blockquote>
<div><p>CloudTrail User
<a class="reference external" href="https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-event-reference-user-identity.html">https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-event-reference-user-identity.html</a></p>
</div></blockquote>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">principal_id_tag</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">tag</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">auto-tag-user</span>
  <span class="nt">update</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">user-type</span><span class="p">:</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">enum</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">IAMUser</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">AssumedRole</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">FederatedUser</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">tag</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="copy-related-tag">
<span id="aws-common-actions-copy-related-tag"></span><h2>copy-related-tag<a class="headerlink" href="#copy-related-tag" title="Permalink to this headline">¶</a></h2>
<p>Copy a related resource tag to its associated resource</p>
<p>In some scenarios, resource tags from a related resource should be applied
to its child resource. For example, EBS Volume tags propogating to their
snapshots. To use this action, specify the resource type that contains the
tags that are to be copied, which can be found by using the
<cite>custodian schema</cite> command.</p>
<p>Then, specify the key on the resource that references the related resource.
In the case of ebs-snapshot, the VolumeId attribute would be the key that
identifies the related resource, ebs.</p>
<p>Finally, specify a list of tag keys to copy from the related resource onto
the original resource. The special character “*” can be used to signify that
all tags from the related resource should be copied to the original resource.</p>
<p>To raise an error when related resources cannot be found, use the
<cite>skip_missing</cite> option. By default, this is set to True.</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">copy-tags-from-ebs-volume-to-snapshot</span>
      <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ebs-snapshot</span>
      <span class="nt">actions</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">copy-related-tag</span>
          <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ebs</span>
          <span class="nt">skip_missing</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
          <span class="nt">key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">VolumeId</span>
          <span class="nt">tags</span><span class="p">:</span> <span class="s">&#39;*&#39;</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">key</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">resource</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">skip_missing</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">tags</span><span class="p">:</span>
    <span class="nt">oneOf</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">enum</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="s">&#39;*&#39;</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">copy-related-tag</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">tags</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">key</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">resource</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="invoke-lambda">
<span id="aws-common-actions-invoke-lambda"></span><h2>invoke-lambda<a class="headerlink" href="#invoke-lambda" title="Permalink to this headline">¶</a></h2>
<p>Invoke an arbitrary lambda</p>
<p>serialized invocation parameters</p>
<blockquote>
<div><ul class="simple">
<li><p>resources / collection of resources</p></li>
<li><p>policy / policy that is invoke the lambda</p></li>
<li><p>action / action that is invoking the lambda</p></li>
<li><p>event / cloud trail event if any</p></li>
<li><p>version / version of custodian invoking the lambda</p></li>
</ul>
</div></blockquote>
<p>We automatically batch into sets of 250 for invocation,
We try to utilize async invocation by default, this imposes
some greater size limits of 128kb which means we batch
invoke.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="nb">type</span><span class="p">:</span> <span class="n">invoke</span><span class="o">-</span><span class="k">lambda</span>
  <span class="n">function</span><span class="p">:</span> <span class="n">my</span><span class="o">-</span><span class="n">function</span>
</pre></div>
</div>
<p>Note if your synchronously invoking the lambda, you may also need
to configure the timeout, to avoid multiple invokes. The default
is 90s, if the lambda doesn’t respond within that time the boto
sdk will invoke the lambda again with the same
arguments. Alternatively use async: true</p>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">async</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">batch_size</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
  <span class="nt">function</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">qualifier</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">timeout</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">invoke-lambda</span>
  <span class="nt">vars</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">function</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="invoke-sfn">
<span id="aws-common-actions-invoke-sfn"></span><h2>invoke-sfn<a class="headerlink" href="#invoke-sfn" title="Permalink to this headline">¶</a></h2>
<p>Invoke step function on resources.</p>
<p>By default this will invoke a step function for each resource
providing both the <cite>policy</cite> and <cite>resource</cite> as input.</p>
<p>That behavior can be configured setting policy and bulk
boolean flags on the action.</p>
<p>If bulk action parameter is set to true, then the step
function will be invoked in bulk, with a set of resource arns
under the <cite>resources</cite> key.</p>
<p>The size of the batch can be configured via the batch-size
parameter. Note step function state (input, execution, etc)must
fit within 32k, we default to batch size 250.</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">invoke-step-function</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">s3</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">is-log-target</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;tag:IngestSetup&quot;</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">absent</span>
    <span class="nt">actions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">invoke-sfn</span>
        <span class="c1"># This will cause the workflow to be invoked</span>
        <span class="c1"># with many resources arns in a single execution.</span>
        <span class="c1"># Note this is *not* the default.</span>
        <span class="nt">bulk</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">batch-size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10</span>
        <span class="nt">state-machine</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">LogIngestSetup</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">batch-size</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
  <span class="nt">bulk</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">policy</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">state-machine</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">invoke-sfn</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">state-machine</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="mark-for-op">
<span id="aws-common-actions-mark-for-op"></span><h2>mark-for-op<a class="headerlink" href="#mark-for-op" title="Permalink to this headline">¶</a></h2>
<p>Tag resources for future action.</p>
<dl class="field-list">
<dt class="field-odd">example</dt>
<dd class="field-odd"><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2-mark-stop</span>
  <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
  <span class="nt">filters</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">image-age</span>
      <span class="nt">op</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ge</span>
      <span class="nt">days</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">90</span>
  <span class="nt">actions</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mark-for-op</span>
      <span class="nt">tag</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">custodian_cleanup</span>
      <span class="nt">op</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">terminate</span>
      <span class="nt">days</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">4</span>
</pre></div>
</div>
</dd>
</dl>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">days</span><span class="p">:</span>
    <span class="nt">exclusiveMinimum</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="nt">minimum</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
  <span class="nt">hours</span><span class="p">:</span>
    <span class="nt">exclusiveMinimum</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="nt">minimum</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
  <span class="nt">msg</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">op</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">tag</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">mark-for-op</span>
  <span class="nt">tz</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="modify-policy">
<span id="aws-common-actions-modify-policy"></span><h2>modify-policy<a class="headerlink" href="#modify-policy" title="Permalink to this headline">¶</a></h2>
<p>Action to modify resource IAM policy statements.</p>
<p>Applies to all resources with embedded IAM Policies.</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
   <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">sns-cross-account</span>
     <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">sns</span>
     <span class="nt">filters</span><span class="p">:</span>
       <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cross-account</span>
     <span class="nt">actions</span><span class="p">:</span>
       <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">modify-policy</span>
         <span class="nt">add-statements</span><span class="p">:</span> <span class="p p-Indicator">[{</span>
             <span class="s">&quot;Sid&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;ReplaceWithMe&quot;</span><span class="p p-Indicator">,</span>
             <span class="s">&quot;Effect&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;Allow&quot;</span><span class="p p-Indicator">,</span>
             <span class="s">&quot;Principal&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;*&quot;</span><span class="p p-Indicator">,</span>
             <span class="s">&quot;Action&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;SNS:GetTopicAttributes&quot;</span><span class="p p-Indicator">],</span>
             <span class="s">&quot;Resource&quot;</span><span class="p p-Indicator">:</span> <span class="nv">topic_arn</span><span class="p p-Indicator">,</span>
                 <span class="p p-Indicator">}]</span>
         <span class="nt">remove-statements</span><span class="p">:</span> <span class="s">&#39;*&#39;</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">add-statements</span><span class="p">:</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">additionalProperties</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
      <span class="nt">oneOf</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">required</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Principal</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Action</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Resource</span>
      <span class="p p-Indicator">-</span> <span class="nt">required</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">NotPrincipal</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Action</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Resource</span>
      <span class="p p-Indicator">-</span> <span class="nt">required</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Principal</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">NotAction</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Resource</span>
      <span class="p p-Indicator">-</span> <span class="nt">required</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">NotPrincipal</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">NotAction</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Resource</span>
      <span class="p p-Indicator">-</span> <span class="nt">required</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Principal</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Action</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">NotResource</span>
      <span class="p p-Indicator">-</span> <span class="nt">required</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">NotPrincipal</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Action</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">NotResource</span>
      <span class="p p-Indicator">-</span> <span class="nt">required</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Principal</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">NotAction</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">NotResource</span>
      <span class="p p-Indicator">-</span> <span class="nt">required</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">NotPrincipal</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">NotAction</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">NotResource</span>
      <span class="nt">properties</span><span class="p">:</span>
        <span class="nt">Action</span><span class="p">:</span>
          <span class="nt">anyOf</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
          <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
        <span class="nt">Condition</span><span class="p">:</span>
          <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
        <span class="nt">Effect</span><span class="p">:</span>
          <span class="nt">enum</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Allow</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Deny</span>
          <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
        <span class="nt">NotAction</span><span class="p">:</span>
          <span class="nt">anyOf</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
          <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
        <span class="nt">NotPrincipal</span><span class="p">:</span>
          <span class="nt">anyOf</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
          <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
        <span class="nt">NotResource</span><span class="p">:</span>
          <span class="nt">anyOf</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
          <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
        <span class="nt">Principal</span><span class="p">:</span>
          <span class="nt">anyOf</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
          <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
          <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
        <span class="nt">Resource</span><span class="p">:</span>
          <span class="nt">anyOf</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
          <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
        <span class="nt">Sid</span><span class="p">:</span>
          <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
      <span class="nt">required</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Sid</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Effect</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
  <span class="nt">remove-statements</span><span class="p">:</span>
    <span class="nt">oneOf</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">enum</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">matched</span>
      <span class="p p-Indicator">-</span> <span class="s">&#39;*&#39;</span>
    <span class="p p-Indicator">-</span> <span class="nt">items</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
    <span class="nt">type</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">modify-policy</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="modify-security-groups">
<span id="aws-common-actions-modify-security-groups"></span><h2>modify-security-groups<a class="headerlink" href="#modify-security-groups" title="Permalink to this headline">¶</a></h2>
<p>Remove security groups from an interface.</p>
<p>Can target either physical groups as a list of group ids or
symbolic groups like ‘matched’ or ‘all’. ‘matched’ uses
the annotations of the ‘group’ interface filter.</p>
<p>Note an interface always gets at least one security group, so
we also allow specification of an isolation/quarantine group
that can be specified if there would otherwise be no groups.</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">network-interface-remove-group</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">eni</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">security-group</span>
        <span class="nt">match-resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">FromPort</span>
        <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">22</span>
    <span class="nt">actions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">modify-security-groups</span>
        <span class="nt">isolation-group</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">sg-01ab23c4</span>
        <span class="nt">add</span><span class="p">:</span> <span class="p p-Indicator">[]</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">anyOf</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">required</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">isolation-group</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">remove</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
<span class="p p-Indicator">-</span> <span class="nt">required</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">add</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">remove</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
<span class="p p-Indicator">-</span> <span class="nt">required</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">add</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
<span class="nt">properties</span><span class="p">:</span>
  <span class="nt">add</span><span class="p">:</span>
    <span class="nt">oneOf</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="p p-Indicator">-</span> <span class="nt">items</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
  <span class="nt">isolation-group</span><span class="p">:</span>
    <span class="nt">oneOf</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="p p-Indicator">-</span> <span class="nt">items</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
  <span class="nt">remove</span><span class="p">:</span>
    <span class="nt">oneOf</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">items</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
    <span class="p p-Indicator">-</span> <span class="nt">enum</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">matched</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">network-location</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">all</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">modify-security-groups</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="normalize-tag">
<span id="aws-common-actions-normalize-tag"></span><h2>normalize-tag<a class="headerlink" href="#normalize-tag" title="Permalink to this headline">¶</a></h2>
<p>Transform the value of a tag.</p>
<p>Set the tag value to uppercase, title, lowercase, or strip text
from a tag key.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2-service-transform-lower</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
    <span class="nt">comment</span><span class="p">:</span> <span class="p p-Indicator">|</span>
      <span class="no">ec2-service-tag-value-to-lower</span>
    <span class="nt">query</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">instance-state-name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">running</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;tag:testing8882&quot;</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">present</span>
    <span class="nt">actions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">normalize-tag</span>
        <span class="nt">key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">lower_key</span>
        <span class="nt">action</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">lower</span>

  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2-service-strip</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
    <span class="nt">comment</span><span class="p">:</span> <span class="p p-Indicator">|</span>
      <span class="no">ec2-service-tag-strip-blah</span>
    <span class="nt">query</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">instance-state-name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">running</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;tag:testing8882&quot;</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">present</span>
    <span class="nt">actions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">normalize-tag</span>
        <span class="nt">key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">strip_key</span>
        <span class="nt">action</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">strip</span>
        <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">blah</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">action</span><span class="p">:</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">enum</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">upper</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lower</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">titlestrip</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">replace</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">key</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">normalize-tag</span>
  <span class="nt">value</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="notify">
<span id="aws-common-actions-notify"></span><h2>notify<a class="headerlink" href="#notify" title="Permalink to this headline">¶</a></h2>
<p>Flexible notifications require quite a bit of implementation support
on pluggable transports, templates, address resolution, variable
extraction, batch periods, etc.</p>
<p>For expedience and flexibility then, we instead send the data to
an sqs queue, for processing. ie. actual communications can be enabled
with the c7n-mailer tool, found under tools/c7n_mailer.</p>
<p>Attaching additional string message attributes are supported on the SNS
transport, with the exception of the <code class="docutils literal notranslate"><span class="pre">mtype</span></code> attribute, which is a
reserved attribute used by Cloud Custodian.</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2-bad-instance-kill</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
    <span class="nt">filters</span><span class="p">:</span>
     <span class="p p-Indicator">-</span> <span class="nt">Name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">bad-instance</span>
    <span class="nt">actions</span><span class="p">:</span>
     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">terminate</span>
     <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">notify</span>
       <span class="nt">to</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">event-user</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">resource-creator</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">email@address</span>
       <span class="nt">owner_absent_contact</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">other_email@address</span>
       <span class="c1"># which template for the email should we use</span>
       <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">policy-template</span>
       <span class="nt">transport</span><span class="p">:</span>
         <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">sqs</span>
         <span class="nt">region</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">us-east-1</span>
         <span class="nt">queue</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">xyz</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2-notify-with-attributes</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
    <span class="nt">filters</span><span class="p">:</span>
     <span class="p p-Indicator">-</span> <span class="nt">Name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">bad-instance</span>
    <span class="nt">actions</span><span class="p">:</span>
     <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">notify</span>
       <span class="nt">to</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">event-user</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">resource-creator</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">email@address</span>
       <span class="nt">owner_absent_contact</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">other_email@address</span>
       <span class="c1"># which template for the email should we use</span>
       <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">policy-template</span>
       <span class="nt">transport</span><span class="p">:</span>
         <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">sns</span>
         <span class="nt">region</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">us-east-1</span>
         <span class="nt">topic</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">your-notify-topic</span>
         <span class="nt">attributes</span><span class="p">:</span>
            <span class="nt">attribute_key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">attribute_value</span>
            <span class="nt">attribute_key_2</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">attribute_value_2</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">anyOf</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">required</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">transport</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">to</span>
<span class="p p-Indicator">-</span> <span class="nt">required</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">transport</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">to_from</span>
<span class="nt">properties</span><span class="p">:</span>
  <span class="nt">assume_role</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">cc</span><span class="p">:</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
  <span class="nt">cc_from</span><span class="p">:</span> <span class="nl">&amp;id001</span>
    <span class="nt">additionalProperties</span><span class="p">:</span> <span class="s">&#39;False&#39;</span>
    <span class="nt">properties</span><span class="p">:</span>
      <span class="nt">expr</span><span class="p">:</span>
        <span class="nt">oneOf</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
        <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
      <span class="nt">format</span><span class="p">:</span>
        <span class="nt">enum</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">csv</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">json</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">txt</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">csv2dict</span>
      <span class="nt">url</span><span class="p">:</span>
        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">required</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">url</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
  <span class="nt">cc_manager</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">from</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">owner_absent_contact</span><span class="p">:</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
  <span class="nt">subject</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">template</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">to</span><span class="p">:</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
  <span class="nt">to_from</span><span class="p">:</span> <span class="nv">*id001</span>
  <span class="nt">transport</span><span class="p">:</span>
    <span class="nt">oneOf</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">properties</span><span class="p">:</span>
        <span class="nt">queue</span><span class="p">:</span>
          <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
        <span class="nt">type</span><span class="p">:</span>
          <span class="nt">enum</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">sqs</span>
      <span class="nt">required</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">queue</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
    <span class="p p-Indicator">-</span> <span class="nt">properties</span><span class="p">:</span>
        <span class="nt">attributes</span><span class="p">:</span>
          <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
        <span class="nt">topic</span><span class="p">:</span>
          <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
        <span class="nt">type</span><span class="p">:</span>
          <span class="nt">enum</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">sns</span>
      <span class="nt">required</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">topic</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">notify</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="post-finding">
<span id="aws-common-actions-post-finding"></span><h2>post-finding<a class="headerlink" href="#post-finding" title="Permalink to this headline">¶</a></h2>
<p>Report a finding to AWS Security Hub.</p>
<p>Custodian acts as a finding provider, allowing users to craft
policies that report to the AWS SecurityHub.</p>
<p>For resources that are taggable, we will tag the resource with an identifier
such that further findings generate updates.</p>
<p>Example generate a finding for accounts that don’t have shield enabled.</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>

 <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">account-shield-enabled</span>
   <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">account</span>
   <span class="nt">filters</span><span class="p">:</span>
     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">shield-enabled</span>
   <span class="nt">actions</span><span class="p">:</span>
     <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">post-finding</span>
       <span class="nt">description</span><span class="p">:</span> <span class="p p-Indicator">|</span>
          <span class="no">Shield should be enabled on account to allow for DDOS protection (1 time 3k USD Charge).</span>
       <span class="nt">severity_normalized</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">6</span>
       <span class="nt">types</span><span class="p">:</span>
         <span class="p p-Indicator">-</span> <span class="s">&quot;Software</span><span class="nv"> </span><span class="s">and</span><span class="nv"> </span><span class="s">Configuration</span><span class="nv"> </span><span class="s">Checks/Industry</span><span class="nv"> </span><span class="s">and</span><span class="nv"> </span><span class="s">Regulatory</span><span class="nv"> </span><span class="s">Standards/NIST</span><span class="nv"> </span><span class="s">CSF</span><span class="nv"> </span><span class="s">Controls</span><span class="nv"> </span><span class="s">(USA)&quot;</span>
       <span class="nt">recommendation</span><span class="p">:</span> <span class="s">&quot;Enable</span><span class="nv"> </span><span class="s">shield&quot;</span>
       <span class="nt">recommendation_url</span><span class="p">:</span> <span class="s">&quot;https://www.example.com/policies/AntiDDoS.html&quot;</span>
       <span class="nt">confidence</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">100</span>
       <span class="nt">compliance_status</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">FAILED</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">batch_size</span><span class="p">:</span>
    <span class="nt">maximum</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10</span>
    <span class="nt">minimum</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
  <span class="nt">compliance_status</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">PASSED</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">WARNING</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">FAILED</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">NOT_AVAILABLE</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">confidence</span><span class="p">:</span>
    <span class="nt">max</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">100</span>
    <span class="nt">min</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
  <span class="nt">criticality</span><span class="p">:</span>
    <span class="nt">max</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">100</span>
    <span class="nt">min</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
  <span class="nt">description</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">fields</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
  <span class="nt">recommendation</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">recommendation_url</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">region</span><span class="p">:</span>
    <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cross-region aggregation target</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">severity</span><span class="p">:</span>
    <span class="nt">default</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
  <span class="nt">severity_normalized</span><span class="p">:</span>
    <span class="nt">default</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
    <span class="nt">max</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">100</span>
    <span class="nt">min</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
  <span class="nt">title</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">post-finding</span>
  <span class="nt">types</span><span class="p">:</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">minItems</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">types</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="put-metric">
<span id="aws-common-actions-put-metric"></span><h2>put-metric<a class="headerlink" href="#put-metric" title="Permalink to this headline">¶</a></h2>
<p>Action to put metrics based on an expression into CloudWatch metrics</p>
<dl class="field-list simple">
<dt class="field-odd">example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">track-attached-ebs</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
    <span class="nt">comment</span><span class="p">:</span> <span class="p p-Indicator">|</span>
      <span class="no">Put the count of the number of EBS attached disks to an instance</span>
    <span class="nt">filters</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">Name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">tracked-ec2-instance</span>
    <span class="nt">actions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">put-metric</span>
        <span class="nt">key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Reservations[].Instances[].BlockDeviceMappings[].DeviceName</span>
        <span class="nt">namespace</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Usage Metrics</span>
        <span class="nt">metric_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Attached Disks</span>
        <span class="nt">op</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">count</span>
        <span class="nt">units</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Count</span>
</pre></div>
</div>
<p>op and units are optional and will default to simple Counts.</p>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">dimensions</span><span class="p">:</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
  <span class="nt">key</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">metric_name</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">namespace</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">op</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">count</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">distinct_count</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">sum</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">average</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">put-metric</span>
  <span class="nt">units</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Seconds</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Microseconds</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Milliseconds</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Bytes</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Kilobytes</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Megabytes</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Gigabytes</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Terabytes</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Bits</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Kilobits</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Megabits</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Gigabits</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Terabits</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Bytes/Second</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Kilobytes/Second</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Megabytes/Second</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Gigabytes/Second</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Terabytes/Second</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Bits/Second</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Kilobits/Second</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Megabits/Second</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Gigabits/Second</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Terabits/Second</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Count/Second</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Percent</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Count</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">None</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">key</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">namespace</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">metric_name</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="remove-tag">
<span id="aws-common-actions-remove-tag"></span><h2>remove-tag<a class="headerlink" href="#remove-tag" title="Permalink to this headline">¶</a></h2>
<p>Removes the specified tags from the specified resources.</p>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">tags</span><span class="p">:</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">remove-tag</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">unmark</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">untag</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">remove-tag</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="rename-tag">
<span id="aws-common-actions-rename-tag"></span><h2>rename-tag<a class="headerlink" href="#rename-tag" title="Permalink to this headline">¶</a></h2>
<p>Create a new tag with identical value &amp; remove old tag</p>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">new_key</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">old_key</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">rename-tag</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="tag">
<span id="aws-common-actions-tag"></span><h2>tag<a class="headerlink" href="#tag" title="Permalink to this headline">¶</a></h2>
<p>Applies one or more tags to the specified resources.</p>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">key</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">tag</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">tags</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">tag</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">mark</span>
  <span class="nt">value</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="tag-trim">
<span id="aws-common-actions-tag-trim"></span><h2>tag-trim<a class="headerlink" href="#tag-trim" title="Permalink to this headline">¶</a></h2>
<p>Automatically remove tags from an ec2 resource.</p>
<p>EC2 Resources have a limit of 50 tags, in order to make
additional tags space on a set of resources, this action can
be used to remove enough tags to make the desired amount of
space while preserving a given set of tags.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2-tag-trim</span>
    <span class="nt">comment</span><span class="p">:</span> <span class="p p-Indicator">|</span>
      <span class="no">Any instances with 48 or more tags get tags removed until</span>
      <span class="no">they match the target tag count, in this case 47 so we</span>
      <span class="no">that we free up a tag slot for another usage.</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
    <span class="nt">filters</span><span class="p">:</span>
          <span class="c1"># Filter down to resources which already have 8 tags</span>
          <span class="c1"># as we need space for 3 more, this also ensures that</span>
          <span class="c1"># metrics reporting is correct for the policy.</span>
        <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">value</span>
          <span class="nt">key</span><span class="p">:</span> <span class="s">&quot;length(Tags)&quot;</span>
          <span class="nt">op</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ge</span>
          <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">48</span>
    <span class="nt">actions</span><span class="p">:</span>
       <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">tag-trim</span>
         <span class="nt">space</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">3</span>
         <span class="nt">preserve</span><span class="p">:</span>
           <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">OwnerContact</span>
           <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ASV</span>
           <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">CMDBEnvironment</span>
           <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">downtime</span>
           <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">custodian_status</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">preserve</span><span class="p">:</span>
    <span class="nt">items</span><span class="p">:</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">array</span>
  <span class="nt">space</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">integer</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">tag-trim</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="webhook">
<span id="aws-common-actions-webhook"></span><h2>webhook<a class="headerlink" href="#webhook" title="Permalink to this headline">¶</a></h2>
<p>Calls a webhook with optional parameters and body
populated from JMESPath queries.</p>
<blockquote>
<div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">call-webhook</span>
    <span class="nt">resource</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
    <span class="nt">description</span><span class="p">:</span> <span class="p p-Indicator">|</span>
      <span class="no">Call webhook with list of resource groups</span>
    <span class="nt">actions</span><span class="p">:</span>
     <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">webhook</span>
       <span class="nt">url</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">http://foo.com</span>
       <span class="nt">query-params</span><span class="p">:</span>
          <span class="nt">resource_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">resource.name</span>
          <span class="nt">policy_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">policy.name</span>
</pre></div>
</div>
</div></blockquote>
<div class="toggle docutils container">
<div class="header docutils container" style=""></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">properties</span><span class="p">:</span>
  <span class="nt">batch</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">boolean</span>
  <span class="nt">batch-size</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">number</span>
  <span class="nt">body</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">headers</span><span class="p">:</span>
    <span class="nt">additionalProperties</span><span class="p">:</span>
      <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">header values</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
  <span class="nt">method</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">PUT</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">POST</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">GET</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">PATCH</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">DELETE</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
  <span class="nt">query-params</span><span class="p">:</span>
    <span class="nt">additionalProperties</span><span class="p">:</span>
      <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">query string values</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">object</span>
  <span class="nt">type</span><span class="p">:</span>
    <span class="nt">enum</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">webhook</span>
  <span class="nt">url</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="nt">required</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">url</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="aws-common-filters.html" class="btn btn-neutral float-right" title="AWS Common Filters" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="AWS Reference" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Capital One Services, LLC

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>